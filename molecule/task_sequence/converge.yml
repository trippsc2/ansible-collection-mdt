---
- name: Converge # noqa complexity[play]
  hosts:
    - subjects
  tasks:
    - name: Create MDT Task Sequence with no key or admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-NO-ADMIN
        name: No Key or Admin Password
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _no_key_or_admin_password_check

    - name: Verify No Key or Admin Password previous output # noqa no-handler
      when:
        - _no_key_or_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password_check.diff.before == None
        fail_msg: The No Key or Admin Password previous output is not as expected.
        success_msg: The No Key or Admin Password previous output is as expected.

    - name: Verify No Key or Admin Password output
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password_check.task_sequence is defined
          - _no_key_or_admin_password_check.task_sequence.id == "NONE-NO-ADMIN"
          - _no_key_or_admin_password_check.task_sequence.name == "No Key or Admin Password"
          - _no_key_or_admin_password_check.task_sequence.template == "Client.xml"
          - _no_key_or_admin_password_check.task_sequence.product_key_type == "none"
          - _no_key_or_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _no_key_or_admin_password_check.task_sequence.full_name == "Test User"
          - _no_key_or_admin_password_check.task_sequence.organization == "Test Organization"
          - _no_key_or_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _no_key_or_admin_password_check.task_sequence.version == "1.0"
          - _no_key_or_admin_password_check.task_sequence.comments == ""
          - _no_key_or_admin_password_check.task_sequence.enabled
          - not _no_key_or_admin_password_check.task_sequence.hidden
          - _no_key_or_admin_password_check.task_sequence.paths is defined
          - _no_key_or_admin_password_check.task_sequence.paths | length == 1
          - _no_key_or_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The No Key or Admin Password output is not as expected.
        success_msg: The No Key or Admin Password output is as expected.

    - name: Create MDT Task Sequence with no key or admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-NO-ADMIN
        name: No Key or Admin Password
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _no_key_or_admin_password

    - name: Verify No Key or Admin Password previous output # noqa no-handler
      when:
        - _no_key_or_admin_password is changed
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password.diff.before == None
        fail_msg: The No Key or Admin Password previous output is not as expected.
        success_msg: The No Key or Admin Password previous output is as expected.

    - name: Verify No Key or Admin Password output
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password.task_sequence is defined
          - _no_key_or_admin_password.task_sequence.id == "NONE-NO-ADMIN"
          - _no_key_or_admin_password.task_sequence.name == "No Key or Admin Password"
          - _no_key_or_admin_password.task_sequence.template == "Client.xml"
          - _no_key_or_admin_password.task_sequence.product_key_type == "none"
          - _no_key_or_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _no_key_or_admin_password.task_sequence.full_name == "Test User"
          - _no_key_or_admin_password.task_sequence.organization == "Test Organization"
          - _no_key_or_admin_password.task_sequence.ie_home_page == "about:blank"
          - _no_key_or_admin_password.task_sequence.version == "1.0"
          - _no_key_or_admin_password.task_sequence.comments == ""
          - _no_key_or_admin_password.task_sequence.enabled
          - not _no_key_or_admin_password.task_sequence.hidden
          - _no_key_or_admin_password.task_sequence.paths is defined
          - _no_key_or_admin_password.task_sequence.paths | length == 1
          - _no_key_or_admin_password.task_sequence.paths[0] == ""
        fail_msg: The No Key or Admin Password output is not as expected.
        success_msg: The No Key or Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password_check.changed == _no_key_or_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check No Key or Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: NONE-NO-ADMIN
        include_secrets: true
      register: _no_key_or_admin_password_secrets

    - name: Verify No Key or Admin Password secrets
      ansible.builtin.assert:
        that:
          - _no_key_or_admin_password_secrets.task_sequence is defined
          - _no_key_or_admin_password_secrets.task_sequence.product_key_type == "none"
          - _no_key_or_admin_password_secrets.task_sequence.product_key is not defined
          - _no_key_or_admin_password_secrets.task_sequence.admin_password is not defined
        fail_msg: The No Key or Admin Password secrets are not as expected.
        success_msg: The No Key or Admin Password secrets are as expected.

    - name: Create MDT Task Sequence with MAK key and no admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-NO-ADMIN
        name: MAK Key and No Admin Password
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_key_no_admin_password_check

    - name: Verify MAK Key and No Admin Password previous output # noqa no-handler
      when:
        - _mak_key_no_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password_check.diff.before == None
        fail_msg: The MAK Key and No Admin Password previous output is not as expected.
        success_msg: The MAK Key and No Admin Password previous output is as expected.

    - name: Verify MAK Key and No Admin Password output
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password_check.task_sequence is defined
          - _mak_key_no_admin_password_check.task_sequence.id == "MAK-NO-ADMIN"
          - _mak_key_no_admin_password_check.task_sequence.name == "MAK Key and No Admin Password"
          - _mak_key_no_admin_password_check.task_sequence.template == "Client.xml"
          - _mak_key_no_admin_password_check.task_sequence.product_key_type == "mak"
          - _mak_key_no_admin_password_check.task_sequence.product_key is not defined
          - _mak_key_no_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_key_no_admin_password_check.task_sequence.full_name == "Test User"
          - _mak_key_no_admin_password_check.task_sequence.organization == "Test Organization"
          - _mak_key_no_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _mak_key_no_admin_password_check.task_sequence.version == "1.0"
          - _mak_key_no_admin_password_check.task_sequence.comments == ""
          - _mak_key_no_admin_password_check.task_sequence.enabled
          - not _mak_key_no_admin_password_check.task_sequence.hidden
          - _mak_key_no_admin_password_check.task_sequence.paths is defined
          - _mak_key_no_admin_password_check.task_sequence.paths | length == 1
          - _mak_key_no_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The MAK Key and No Admin Password output is not as expected.
        success_msg: The MAK Key and No Admin Password output is as expected.

    - name: Create MDT Task Sequence with MAK key and no admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-NO-ADMIN
        name: MAK Key and No Admin Password
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_key_no_admin_password

    - name: Verify MAK Key and No Admin Password previous output # noqa no-handler
      when:
        - _mak_key_no_admin_password is changed
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password.diff.before == None
        fail_msg: The MAK Key and No Admin Password previous output is not as expected.
        success_msg: The MAK Key and No Admin Password previous output is as expected.

    - name: Verify MAK Key and No Admin Password output
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password.task_sequence is defined
          - _mak_key_no_admin_password.task_sequence.id == "MAK-NO-ADMIN"
          - _mak_key_no_admin_password.task_sequence.name == "MAK Key and No Admin Password"
          - _mak_key_no_admin_password.task_sequence.template == "Client.xml"
          - _mak_key_no_admin_password.task_sequence.product_key_type == "mak"
          - _mak_key_no_admin_password.task_sequence.product_key is not defined
          - _mak_key_no_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_key_no_admin_password.task_sequence.full_name == "Test User"
          - _mak_key_no_admin_password.task_sequence.organization == "Test Organization"
          - _mak_key_no_admin_password.task_sequence.ie_home_page == "about:blank"
          - _mak_key_no_admin_password.task_sequence.version == "1.0"
          - _mak_key_no_admin_password.task_sequence.comments == ""
          - _mak_key_no_admin_password.task_sequence.enabled
          - not _mak_key_no_admin_password.task_sequence.hidden
          - _mak_key_no_admin_password.task_sequence.paths is defined
          - _mak_key_no_admin_password.task_sequence.paths | length == 1
          - _mak_key_no_admin_password.task_sequence.paths[0] == ""
        fail_msg: The MAK Key and No Admin Password output is not as expected.
        success_msg: The MAK Key and No Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password_check.changed == _mak_key_no_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check MAK Key and No Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: MAK-NO-ADMIN
        include_secrets: true
      register: _mak_key_no_admin_password_secrets

    - name: Verify MAK Key and No Admin Password secrets
      ansible.builtin.assert:
        that:
          - _mak_key_no_admin_password_secrets.task_sequence is defined
          - _mak_key_no_admin_password_secrets.task_sequence.product_key_type == "mak"
          - _mak_key_no_admin_password_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _mak_key_no_admin_password_secrets.task_sequence.admin_password is not defined
        fail_msg: The MAK Key and No Admin Password secrets are not as expected.
        success_msg: The MAK Key and No Admin Password secrets are as expected.

    - name: Create MDT Task Sequence with retail key and no admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NO-ADMIN
        name: Retail Key and No Admin Password
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_key_no_admin_password_check

    - name: Verify Retail Key and No Admin Password previous output # noqa no-handler
      when:
        - _retail_key_no_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password_check.diff.before == None
        fail_msg: The Retail Key and No Admin Password previous output is not as expected.
        success_msg: The Retail Key and No Admin Password previous output is as expected.

    - name: Verify Retail Key and No Admin Password output
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password_check.task_sequence is defined
          - _retail_key_no_admin_password_check.task_sequence.id == "RETAIL-NO-ADMIN"
          - _retail_key_no_admin_password_check.task_sequence.name == "Retail Key and No Admin Password"
          - _retail_key_no_admin_password_check.task_sequence.template == "Client.xml"
          - _retail_key_no_admin_password_check.task_sequence.product_key_type == "retail"
          - _retail_key_no_admin_password_check.task_sequence.product_key is not defined
          - _retail_key_no_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_key_no_admin_password_check.task_sequence.full_name == "Test User"
          - _retail_key_no_admin_password_check.task_sequence.organization == "Test Organization"
          - _retail_key_no_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _retail_key_no_admin_password_check.task_sequence.version == "1.0"
          - _retail_key_no_admin_password_check.task_sequence.comments == ""
          - _retail_key_no_admin_password_check.task_sequence.enabled
          - not _retail_key_no_admin_password_check.task_sequence.hidden
          - _retail_key_no_admin_password_check.task_sequence.paths is defined
          - _retail_key_no_admin_password_check.task_sequence.paths | length == 1
          - _retail_key_no_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The Retail Key and No Admin Password output is not as expected.
        success_msg: The Retail Key and No Admin Password output is as expected.

    - name: Create MDT Task Sequence with retail key and no admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NO-ADMIN
        name: Retail Key and No Admin Password
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_key_no_admin_password

    - name: Verify Retail Key and No Admin Password previous output # noqa no-handler
      when:
        - _retail_key_no_admin_password is changed
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password.diff.before == None
        fail_msg: The Retail Key and No Admin Password previous output is not as expected.
        success_msg: The Retail Key and No Admin Password previous output is as expected.

    - name: Verify Retail Key and No Admin Password output
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password.task_sequence is defined
          - _retail_key_no_admin_password.task_sequence.id == "RETAIL-NO-ADMIN"
          - _retail_key_no_admin_password.task_sequence.name == "Retail Key and No Admin Password"
          - _retail_key_no_admin_password.task_sequence.template == "Client.xml"
          - _retail_key_no_admin_password.task_sequence.product_key_type == "retail"
          - _retail_key_no_admin_password.task_sequence.product_key is not defined
          - _retail_key_no_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_key_no_admin_password.task_sequence.full_name == "Test User"
          - _retail_key_no_admin_password.task_sequence.organization == "Test Organization"
          - _retail_key_no_admin_password.task_sequence.ie_home_page == "about:blank"
          - _retail_key_no_admin_password.task_sequence.version == "1.0"
          - _retail_key_no_admin_password.task_sequence.comments == ""
          - _retail_key_no_admin_password.task_sequence.enabled
          - not _retail_key_no_admin_password.task_sequence.hidden
          - _retail_key_no_admin_password.task_sequence.paths is defined
          - _retail_key_no_admin_password.task_sequence.paths | length == 1
          - _retail_key_no_admin_password.task_sequence.paths[0] == ""
        fail_msg: The Retail Key and No Admin Password output is not as expected.
        success_msg: The Retail Key and No Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password_check.changed == _retail_key_no_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Retail Key and No Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NO-ADMIN
        include_secrets: true
      register: _retail_key_no_admin_password_secrets

    - name: Verify Retail Key and No Admin Password secrets
      ansible.builtin.assert:
        that:
          - _retail_key_no_admin_password_secrets.task_sequence is defined
          - _retail_key_no_admin_password_secrets.task_sequence.product_key_type == "retail"
          - _retail_key_no_admin_password_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _retail_key_no_admin_password_secrets.task_sequence.admin_password is not defined
        fail_msg: The Retail Key and No Admin Password secrets are not as expected.
        success_msg: The Retail Key and No Admin Password secrets are as expected.

    - name: Create MDT Task Sequence with no key and admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-ADMIN
        name: No Key and Admin Password
        template: Client.xml
        product_key_type: none
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _no_key_admin_password_check

    - name: Verify No Key and Admin Password previous output # noqa no-handler
      when:
        - _no_key_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _no_key_admin_password_check.diff.before == None
        fail_msg: The No Key and Admin Password previous output is not as expected.
        success_msg: The No Key and Admin Password previous output is as expected.

    - name: Verify No Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _no_key_admin_password_check.task_sequence is defined
          - _no_key_admin_password_check.task_sequence.id == "NONE-ADMIN"
          - _no_key_admin_password_check.task_sequence.name == "No Key and Admin Password"
          - _no_key_admin_password_check.task_sequence.template == "Client.xml"
          - _no_key_admin_password_check.task_sequence.product_key_type == "none"
          - _no_key_admin_password_check.task_sequence.product_key is not defined
          - _no_key_admin_password_check.task_sequence.admin_password is not defined
          - _no_key_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _no_key_admin_password_check.task_sequence.full_name == "Test User"
          - _no_key_admin_password_check.task_sequence.organization == "Test Organization"
          - _no_key_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _no_key_admin_password_check.task_sequence.version == "1.0"
          - _no_key_admin_password_check.task_sequence.comments == ""
          - _no_key_admin_password_check.task_sequence.enabled
          - not _no_key_admin_password_check.task_sequence.hidden
          - _no_key_admin_password_check.task_sequence.paths is defined
          - _no_key_admin_password_check.task_sequence.paths | length == 1
          - _no_key_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The No Key and Admin Password output is not as expected.
        success_msg: The No Key and Admin Password output is as expected.

    - name: Create MDT Task Sequence with no key and admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-ADMIN
        name: No Key and Admin Password
        template: Client.xml
        product_key_type: none
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _no_key_admin_password

    - name: Verify No Key and Admin Password previous output # noqa no-handler
      when:
        - _no_key_admin_password is changed
      ansible.builtin.assert:
        that:
          - _no_key_admin_password.diff.before == None
        fail_msg: The No Key and Admin Password previous output is not as expected.
        success_msg: The No Key and Admin Password previous output is as expected.

    - name: Verify No Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _no_key_admin_password.task_sequence is defined
          - _no_key_admin_password.task_sequence.id == "NONE-ADMIN"
          - _no_key_admin_password.task_sequence.name == "No Key and Admin Password"
          - _no_key_admin_password.task_sequence.template == "Client.xml"
          - _no_key_admin_password.task_sequence.product_key_type == "none"
          - _no_key_admin_password.task_sequence.product_key is not defined
          - _no_key_admin_password.task_sequence.admin_password is not defined
          - _no_key_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _no_key_admin_password.task_sequence.full_name == "Test User"
          - _no_key_admin_password.task_sequence.organization == "Test Organization"
          - _no_key_admin_password.task_sequence.ie_home_page == "about:blank"
          - _no_key_admin_password.task_sequence.version == "1.0"
          - _no_key_admin_password.task_sequence.comments == ""
          - _no_key_admin_password.task_sequence.enabled
          - not _no_key_admin_password.task_sequence.hidden
          - _no_key_admin_password.task_sequence.paths is defined
          - _no_key_admin_password.task_sequence.paths | length == 1
          - _no_key_admin_password.task_sequence.paths[0] == ""
        fail_msg: The No Key and Admin Password output is not as expected.
        success_msg: The No Key and Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _no_key_admin_password_check.changed == _no_key_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check No Key and Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: NONE-ADMIN
        include_secrets: true
      register: _no_key_admin_password_secrets

    - name: Verify No Key and Admin Password secrets
      ansible.builtin.assert:
        that:
          - _no_key_admin_password_secrets.task_sequence is defined
          - _no_key_admin_password_secrets.task_sequence.product_key_type == "none"
          - _no_key_admin_password_secrets.task_sequence.product_key is not defined
          - _no_key_admin_password_secrets.task_sequence.admin_password == "Password123!"
        fail_msg: The No Key and Admin Password secrets are not as expected.
        success_msg: The No Key and Admin Password secrets are as expected.

    - name: Create MDT Task Sequence with MAK key and admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-ADMIN
        name: MAK Key and Admin Password
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_key_admin_password_check

    - name: Verify MAK Key and Admin Password previous output # noqa no-handler
      when:
        - _mak_key_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password_check.diff.before == None
        fail_msg: The MAK Key and Admin Password previous output is not as expected.
        success_msg: The MAK Key and Admin Password previous output is as expected.

    - name: Verify MAK Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password_check.task_sequence is defined
          - _mak_key_admin_password_check.task_sequence.id == "MAK-ADMIN"
          - _mak_key_admin_password_check.task_sequence.name == "MAK Key and Admin Password"
          - _mak_key_admin_password_check.task_sequence.template == "Client.xml"
          - _mak_key_admin_password_check.task_sequence.product_key_type == "mak"
          - _mak_key_admin_password_check.task_sequence.product_key is not defined
          - _mak_key_admin_password_check.task_sequence.admin_password is not defined
          - _mak_key_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_key_admin_password_check.task_sequence.full_name == "Test User"
          - _mak_key_admin_password_check.task_sequence.organization == "Test Organization"
          - _mak_key_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _mak_key_admin_password_check.task_sequence.version == "1.0"
          - _mak_key_admin_password_check.task_sequence.comments == ""
          - _mak_key_admin_password_check.task_sequence.enabled
          - not _mak_key_admin_password_check.task_sequence.hidden
          - _mak_key_admin_password_check.task_sequence.paths is defined
          - _mak_key_admin_password_check.task_sequence.paths | length == 1
          - _mak_key_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The MAK Key and Admin Password output is not as expected.
        success_msg: The MAK Key and Admin Password output is as expected.

    - name: Create MDT Task Sequence with MAK key and admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-ADMIN
        name: MAK Key and Admin Password
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_key_admin_password

    - name: Verify MAK Key and Admin Password previous output # noqa no-handler
      when:
        - _mak_key_admin_password is changed
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password.diff.before == None
        fail_msg: The MAK Key and Admin Password previous output is not as expected.
        success_msg: The MAK Key and Admin Password previous output is as expected.

    - name: Verify MAK Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password.task_sequence is defined
          - _mak_key_admin_password.task_sequence.id == "MAK-ADMIN"
          - _mak_key_admin_password.task_sequence.name == "MAK Key and Admin Password"
          - _mak_key_admin_password.task_sequence.template == "Client.xml"
          - _mak_key_admin_password.task_sequence.product_key_type == "mak"
          - _mak_key_admin_password.task_sequence.product_key is not defined
          - _mak_key_admin_password.task_sequence.admin_password is not defined
          - _mak_key_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_key_admin_password.task_sequence.full_name == "Test User"
          - _mak_key_admin_password.task_sequence.organization == "Test Organization"
          - _mak_key_admin_password.task_sequence.ie_home_page == "about:blank"
          - _mak_key_admin_password.task_sequence.version == "1.0"
          - _mak_key_admin_password.task_sequence.comments == ""
          - _mak_key_admin_password.task_sequence.enabled
          - not _mak_key_admin_password.task_sequence.hidden
          - _mak_key_admin_password.task_sequence.paths is defined
          - _mak_key_admin_password.task_sequence.paths | length == 1
          - _mak_key_admin_password.task_sequence.paths[0] == ""
        fail_msg: The MAK Key and Admin Password output is not as expected.
        success_msg: The MAK Key and Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password_check.changed == _mak_key_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check MAK Key and Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: MAK-ADMIN
        include_secrets: true
      register: _mak_key_admin_password_secrets

    - name: Verify MAK Key and Admin Password secrets
      ansible.builtin.assert:
        that:
          - _mak_key_admin_password_secrets.task_sequence is defined
          - _mak_key_admin_password_secrets.task_sequence.product_key_type == "mak"
          - _mak_key_admin_password_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _mak_key_admin_password_secrets.task_sequence.admin_password == "Password123!"
        fail_msg: The MAK Key and Admin Password secrets are not as expected.
        success_msg: The MAK Key and Admin Password secrets are as expected.

    - name: Create MDT Task Sequence with retail key and admin password (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-ADMIN
        name: Retail Key and Admin Password
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_key_admin_password_check

    - name: Verify Retail Key and Admin Password previous output # noqa no-handler
      when:
        - _retail_key_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password_check.diff.before == None
        fail_msg: The Retail Key and Admin Password previous output is not as expected.
        success_msg: The Retail Key and Admin Password previous output is as expected.

    - name: Verify Retail Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password_check.task_sequence is defined
          - _retail_key_admin_password_check.task_sequence.id == "RETAIL-ADMIN"
          - _retail_key_admin_password_check.task_sequence.name == "Retail Key and Admin Password"
          - _retail_key_admin_password_check.task_sequence.template == "Client.xml"
          - _retail_key_admin_password_check.task_sequence.product_key_type == "retail"
          - _retail_key_admin_password_check.task_sequence.product_key is not defined
          - _retail_key_admin_password_check.task_sequence.admin_password is not defined
          - _retail_key_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_key_admin_password_check.task_sequence.full_name == "Test User"
          - _retail_key_admin_password_check.task_sequence.organization == "Test Organization"
          - _retail_key_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _retail_key_admin_password_check.task_sequence.version == "1.0"
          - _retail_key_admin_password_check.task_sequence.comments == ""
          - _retail_key_admin_password_check.task_sequence.enabled
          - not _retail_key_admin_password_check.task_sequence.hidden
          - _retail_key_admin_password_check.task_sequence.paths is defined
          - _retail_key_admin_password_check.task_sequence.paths | length == 1
          - _retail_key_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The Retail Key and Admin Password output is not as expected.
        success_msg: The Retail Key and Admin Password output is as expected.

    - name: Create MDT Task Sequence with retail key and admin password
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-ADMIN
        name: Retail Key and Admin Password
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        admin_password: Password123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_key_admin_password

    - name: Verify Retail Key and Admin Password previous output # noqa no-handler
      when:
        - _retail_key_admin_password is changed
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password.diff.before == None
        fail_msg: The Retail Key and Admin Password previous output is not as expected.
        success_msg: The Retail Key and Admin Password previous output is as expected.

    - name: Verify Retail Key and Admin Password output
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password.task_sequence is defined
          - _retail_key_admin_password.task_sequence.id == "RETAIL-ADMIN"
          - _retail_key_admin_password.task_sequence.name == "Retail Key and Admin Password"
          - _retail_key_admin_password.task_sequence.template == "Client.xml"
          - _retail_key_admin_password.task_sequence.product_key_type == "retail"
          - _retail_key_admin_password.task_sequence.product_key is not defined
          - _retail_key_admin_password.task_sequence.admin_password is not defined
          - _retail_key_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_key_admin_password.task_sequence.full_name == "Test User"
          - _retail_key_admin_password.task_sequence.organization == "Test Organization"
          - _retail_key_admin_password.task_sequence.ie_home_page == "about:blank"
          - _retail_key_admin_password.task_sequence.version == "1.0"
          - _retail_key_admin_password.task_sequence.comments == ""
          - _retail_key_admin_password.task_sequence.enabled
          - not _retail_key_admin_password.task_sequence.hidden
          - _retail_key_admin_password.task_sequence.paths is defined
          - _retail_key_admin_password.task_sequence.paths | length == 1
          - _retail_key_admin_password.task_sequence.paths[0] == ""
        fail_msg: The Retail Key and Admin Password output is not as expected.
        success_msg: The Retail Key and Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password_check.changed == _retail_key_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Retail Key and Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: RETAIL-ADMIN
        include_secrets: true
      register: _retail_key_admin_password_secrets

    - name: Verify Retail Key and Admin Password secrets
      ansible.builtin.assert:
        that:
          - _retail_key_admin_password_secrets.task_sequence is defined
          - _retail_key_admin_password_secrets.task_sequence.product_key_type == "retail"
          - _retail_key_admin_password_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _retail_key_admin_password_secrets.task_sequence.admin_password == "Password123!"
        fail_msg: The Retail Key and Admin Password secrets are not as expected.
        success_msg: The Retail Key and Admin Password secrets are as expected.

    - name: Change product key from none to MAK (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-MAK
        name: None To MAK
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _none_to_change_mak_key_check

    - name: Verify None To MAK previous output # noqa no-handler
      when:
        - _none_to_change_mak_key_check is changed
      ansible.builtin.assert:
        that:
          - _none_to_change_mak_key_check.diff.before != None
          - _none_to_change_mak_key_check.diff.before.id == "NONE-MAK"
          - _none_to_change_mak_key_check.diff.before.name == "None To MAK"
          - _none_to_change_mak_key_check.diff.before.template == "Client.xml"
          - _none_to_change_mak_key_check.diff.before.product_key_type == "none"
          - _none_to_change_mak_key_check.diff.before.product_key is not defined
          - _none_to_change_mak_key_check.diff.before.admin_password is not defined
          - _none_to_change_mak_key_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _none_to_change_mak_key_check.diff.before.full_name == "Test User"
          - _none_to_change_mak_key_check.diff.before.organization == "Test Organization"
          - _none_to_change_mak_key_check.diff.before.ie_home_page == "about:blank"
          - _none_to_change_mak_key_check.diff.before.version == "1.0"
          - _none_to_change_mak_key_check.diff.before.comments == ""
          - _none_to_change_mak_key_check.diff.before.enabled
          - not _none_to_change_mak_key_check.diff.before.hidden
          - _none_to_change_mak_key_check.diff.before.paths is defined
          - _none_to_change_mak_key_check.diff.before.paths | length == 1
          - _none_to_change_mak_key_check.diff.before.paths[0] == ""
        fail_msg: The None To MAK previous output is not as expected.
        success_msg: The None To MAK previous output is as expected.

    - name: Verify None To MAK output
      ansible.builtin.assert:
        that:
          - _none_to_change_mak_key_check.task_sequence is defined
          - _none_to_change_mak_key_check.task_sequence.id == "NONE-MAK"
          - _none_to_change_mak_key_check.task_sequence.name == "None To MAK"
          - _none_to_change_mak_key_check.task_sequence.template == "Client.xml"
          - _none_to_change_mak_key_check.task_sequence.product_key_type == "mak"
          - _none_to_change_mak_key_check.task_sequence.product_key is not defined
          - _none_to_change_mak_key_check.task_sequence.admin_password is not defined
          - _none_to_change_mak_key_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _none_to_change_mak_key_check.task_sequence.full_name == "Test User"
          - _none_to_change_mak_key_check.task_sequence.organization == "Test Organization"
          - _none_to_change_mak_key_check.task_sequence.ie_home_page == "about:blank"
          - _none_to_change_mak_key_check.task_sequence.version == "1.0"
          - _none_to_change_mak_key_check.task_sequence.comments == ""
          - _none_to_change_mak_key_check.task_sequence.enabled
          - not _none_to_change_mak_key_check.task_sequence.hidden
          - _none_to_change_mak_key_check.task_sequence.paths is defined
          - _none_to_change_mak_key_check.task_sequence.paths | length == 1
          - _none_to_change_mak_key_check.task_sequence.paths[0] == ""
        fail_msg: The None To MAK output is not as expected.
        success_msg: The None To MAK output is as expected.

    - name: Change product key from none to MAK
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-MAK
        name: None To MAK
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _none_to_mak

    - name: Verify None To MAK previous output # noqa no-handler
      when:
        - _none_to_mak is changed
      ansible.builtin.assert:
        that:
          - _none_to_mak.diff.before != None
          - _none_to_mak.diff.before.id == "NONE-MAK"
          - _none_to_mak.diff.before.name == "None To MAK"
          - _none_to_mak.diff.before.template == "Client.xml"
          - _none_to_mak.diff.before.product_key_type == "none"
          - _none_to_mak.diff.before.product_key is not defined
          - _none_to_mak.diff.before.admin_password is not defined
          - _none_to_mak.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _none_to_mak.diff.before.full_name == "Test User"
          - _none_to_mak.diff.before.organization == "Test Organization"
          - _none_to_mak.diff.before.ie_home_page == "about:blank"
          - _none_to_mak.diff.before.version == "1.0"
          - _none_to_mak.diff.before.comments == ""
          - _none_to_mak.diff.before.enabled
          - not _none_to_mak.diff.before.hidden
          - _none_to_mak.diff.before.paths is defined
          - _none_to_mak.diff.before.paths | length == 1
          - _none_to_mak.diff.before.paths[0] == ""
        fail_msg: The None To MAK previous output is not as expected.
        success_msg: The None To MAK previous output is as expected.

    - name: Verify None To MAK output
      ansible.builtin.assert:
        that:
          - _none_to_mak.task_sequence is defined
          - _none_to_mak.task_sequence.id == "NONE-MAK"
          - _none_to_mak.task_sequence.name == "None To MAK"
          - _none_to_mak.task_sequence.template == "Client.xml"
          - _none_to_mak.task_sequence.product_key_type == "mak"
          - _none_to_mak.task_sequence.product_key is not defined
          - _none_to_mak.task_sequence.admin_password is not defined
          - _none_to_mak.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _none_to_mak.task_sequence.full_name == "Test User"
          - _none_to_mak.task_sequence.organization == "Test Organization"
          - _none_to_mak.task_sequence.ie_home_page == "about:blank"
          - _none_to_mak.task_sequence.version == "1.0"
          - _none_to_mak.task_sequence.comments == ""
          - _none_to_mak.task_sequence.enabled
          - not _none_to_mak.task_sequence.hidden
          - _none_to_mak.task_sequence.paths is defined
          - _none_to_mak.task_sequence.paths | length == 1
          - _none_to_mak.task_sequence.paths[0] == ""
        fail_msg: The None To MAK output is not as expected.
        success_msg: The None To MAK output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _none_to_change_mak_key_check.changed == _none_to_mak.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check None To MAK secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: NONE-MAK
        include_secrets: true
      register: _none_to_mak_secrets

    - name: Verify None To MAK secrets
      ansible.builtin.assert:
        that:
          - _none_to_mak_secrets.task_sequence is defined
          - _none_to_mak_secrets.task_sequence.product_key_type == "mak"
          - _none_to_mak_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _none_to_mak_secrets.task_sequence.admin_password is not defined
        fail_msg: The None To MAK secrets are not as expected.
        success_msg: The None To MAK secrets are as expected.

    - name: Change product key from None to retail (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-RETAIL
        name: None To Retail
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _none_to_retail_check

    - name: Verify None To Retail previous output # noqa no-handler
      when:
        - _none_to_retail_check is changed
      ansible.builtin.assert:
        that:
          - _none_to_retail_check.diff.before != None
          - _none_to_retail_check.diff.before.id == "NONE-RETAIL"
          - _none_to_retail_check.diff.before.name == "None To Retail"
          - _none_to_retail_check.diff.before.template == "Client.xml"
          - _none_to_retail_check.diff.before.product_key_type == "none"
          - _none_to_retail_check.diff.before.product_key is not defined
          - _none_to_retail_check.diff.before.admin_password is not defined
          - _none_to_retail_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _none_to_retail_check.diff.before.full_name == "Test User"
          - _none_to_retail_check.diff.before.organization == "Test Organization"
          - _none_to_retail_check.diff.before.ie_home_page == "about:blank"
          - _none_to_retail_check.diff.before.version == "1.0"
          - _none_to_retail_check.diff.before.comments == ""
          - _none_to_retail_check.diff.before.enabled
          - not _none_to_retail_check.diff.before.hidden
          - _none_to_retail_check.diff.before.paths is defined
          - _none_to_retail_check.diff.before.paths | length == 1
          - _none_to_retail_check.diff.before.paths[0] == ""
        fail_msg: The None To Retail previous output is not as expected.
        success_msg: The None To Retail previous output is as expected.

    - name: Verify None To Retail output
      ansible.builtin.assert:
        that:
          - _none_to_retail_check.task_sequence is defined
          - _none_to_retail_check.task_sequence.id == "NONE-RETAIL"
          - _none_to_retail_check.task_sequence.name == "None To Retail"
          - _none_to_retail_check.task_sequence.template == "Client.xml"
          - _none_to_retail_check.task_sequence.product_key_type == "retail"
          - _none_to_retail_check.task_sequence.product_key is not defined
          - _none_to_retail_check.task_sequence.admin_password is not defined
          - _none_to_retail_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _none_to_retail_check.task_sequence.full_name == "Test User"
          - _none_to_retail_check.task_sequence.organization == "Test Organization"
          - _none_to_retail_check.task_sequence.ie_home_page == "about:blank"
          - _none_to_retail_check.task_sequence.version == "1.0"
          - _none_to_retail_check.task_sequence.comments == ""
          - _none_to_retail_check.task_sequence.enabled
          - not _none_to_retail_check.task_sequence.hidden
          - _none_to_retail_check.task_sequence.paths is defined
          - _none_to_retail_check.task_sequence.paths | length == 1
          - _none_to_retail_check.task_sequence.paths[0] == ""
        fail_msg: The None To Retail output is not as expected.
        success_msg: The None To Retail output is as expected.

    - name: Change product key from None to retail
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: NONE-RETAIL
        name: None To Retail
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _none_to_retail

    - name: Verify None To Retail previous output # noqa no-handler
      when:
        - _none_to_retail is changed
      ansible.builtin.assert:
        that:
          - _none_to_retail.diff.before != None
          - _none_to_retail.diff.before.id == "NONE-RETAIL"
          - _none_to_retail.diff.before.name == "None To Retail"
          - _none_to_retail.diff.before.template == "Client.xml"
          - _none_to_retail.diff.before.product_key_type == "none"
          - _none_to_retail.diff.before.product_key is not defined
          - _none_to_retail.diff.before.admin_password is not defined
          - _none_to_retail.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _none_to_retail.diff.before.full_name == "Test User"
          - _none_to_retail.diff.before.organization == "Test Organization"
          - _none_to_retail.diff.before.ie_home_page == "about:blank"
          - _none_to_retail.diff.before.version == "1.0"
          - _none_to_retail.diff.before.comments == ""
          - _none_to_retail.diff.before.enabled
          - not _none_to_retail.diff.before.hidden
          - _none_to_retail.diff.before.paths is defined
          - _none_to_retail.diff.before.paths | length == 1
          - _none_to_retail.diff.before.paths[0] == ""
        fail_msg: The None To Retail previous output is not as expected.
        success_msg: The None To Retail previous output is as expected.

    - name: Verify None To Retail output
      ansible.builtin.assert:
        that:
          - _none_to_retail.task_sequence is defined
          - _none_to_retail.task_sequence.id == "NONE-RETAIL"
          - _none_to_retail.task_sequence.name == "None To Retail"
          - _none_to_retail.task_sequence.template == "Client.xml"
          - _none_to_retail.task_sequence.product_key_type == "retail"
          - _none_to_retail.task_sequence.product_key is not defined
          - _none_to_retail.task_sequence.admin_password is not defined
          - _none_to_retail.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _none_to_retail.task_sequence.full_name == "Test User"
          - _none_to_retail.task_sequence.organization == "Test Organization"
          - _none_to_retail.task_sequence.ie_home_page == "about:blank"
          - _none_to_retail.task_sequence.version == "1.0"
          - _none_to_retail.task_sequence.comments == ""
          - _none_to_retail.task_sequence.enabled
          - not _none_to_retail.task_sequence.hidden
          - _none_to_retail.task_sequence.paths is defined
          - _none_to_retail.task_sequence.paths | length == 1
          - _none_to_retail.task_sequence.paths[0] == ""
        fail_msg: The None To Retail output is not as expected.
        success_msg: The None To Retail output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _none_to_retail_check.changed == _none_to_retail.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check None To Retail secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: NONE-RETAIL
        include_secrets: true
      register: _none_to_retail_secrets

    - name: Verify None To Retail secrets
      ansible.builtin.assert:
        that:
          - _none_to_retail_secrets.task_sequence is defined
          - _none_to_retail_secrets.task_sequence.product_key_type == "retail"
          - _none_to_retail_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _none_to_retail_secrets.task_sequence.admin_password is not defined
        fail_msg: The None To Retail secrets are not as expected.
        success_msg: The None To Retail secrets are as expected.

    - name: Change product key from MAK to none (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-NONE
        name: MAK To None
        template: Client.xml
        product_key_type: none
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_to_none_check

    - name: Verify MAK To None previous output # noqa no-handler
      when:
        - _mak_to_none_check is changed
      ansible.builtin.assert:
        that:
          - _mak_to_none_check.diff.before != None
          - _mak_to_none_check.diff.before.id == "MAK-NONE"
          - _mak_to_none_check.diff.before.name == "MAK To None"
          - _mak_to_none_check.diff.before.template == "Client.xml"
          - _mak_to_none_check.diff.before.product_key_type == "mak"
          - _mak_to_none_check.diff.before.product_key is not defined
          - _mak_to_none_check.diff.before.admin_password is not defined
          - _mak_to_none_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_none_check.diff.before.full_name == "Test User"
          - _mak_to_none_check.diff.before.organization == "Test Organization"
          - _mak_to_none_check.diff.before.ie_home_page == "about:blank"
          - _mak_to_none_check.diff.before.version == "1.0"
          - _mak_to_none_check.diff.before.comments == ""
          - _mak_to_none_check.diff.before.enabled
          - not _mak_to_none_check.diff.before.hidden
          - _mak_to_none_check.diff.before.paths is defined
          - _mak_to_none_check.diff.before.paths | length == 1
          - _mak_to_none_check.diff.before.paths[0] == ""
        fail_msg: The MAK To None previous output is not as expected.
        success_msg: The MAK To None previous output is as expected.

    - name: Verify MAK To None output
      ansible.builtin.assert:
        that:
          - _mak_to_none_check.task_sequence is defined
          - _mak_to_none_check.task_sequence.id == "MAK-NONE"
          - _mak_to_none_check.task_sequence.name == "MAK To None"
          - _mak_to_none_check.task_sequence.template == "Client.xml"
          - _mak_to_none_check.task_sequence.product_key_type == "none"
          - _mak_to_none_check.task_sequence.product_key is not defined
          - _mak_to_none_check.task_sequence.admin_password is not defined
          - _mak_to_none_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_none_check.task_sequence.full_name == "Test User"
          - _mak_to_none_check.task_sequence.organization == "Test Organization"
          - _mak_to_none_check.task_sequence.ie_home_page == "about:blank"
          - _mak_to_none_check.task_sequence.version == "1.0"
          - _mak_to_none_check.task_sequence.comments == ""
          - _mak_to_none_check.task_sequence.enabled
          - not _mak_to_none_check.task_sequence.hidden
          - _mak_to_none_check.task_sequence.paths is defined
          - _mak_to_none_check.task_sequence.paths | length == 1
          - _mak_to_none_check.task_sequence.paths[0] == ""
        fail_msg: The MAK To None output is not as expected.
        success_msg: The MAK To None output is as expected.

    - name: Change product key from MAK to none
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-NONE
        name: MAK To None
        template: Client.xml
        product_key_type: none
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_to_none

    - name: Verify MAK To None previous output # noqa no-handler
      when:
        - _mak_to_none is changed
      ansible.builtin.assert:
        that:
          - _mak_to_none.diff.before != None
          - _mak_to_none.diff.before.id == "MAK-NONE"
          - _mak_to_none.diff.before.name == "MAK To None"
          - _mak_to_none.diff.before.template == "Client.xml"
          - _mak_to_none.diff.before.product_key_type == "mak"
          - _mak_to_none.diff.before.product_key is not defined
          - _mak_to_none.diff.before.admin_password is not defined
          - _mak_to_none.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_none.diff.before.full_name == "Test User"
          - _mak_to_none.diff.before.organization == "Test Organization"
          - _mak_to_none.diff.before.ie_home_page == "about:blank"
          - _mak_to_none.diff.before.version == "1.0"
          - _mak_to_none.diff.before.comments == ""
          - _mak_to_none.diff.before.enabled
          - not _mak_to_none.diff.before.hidden
          - _mak_to_none.diff.before.paths is defined
          - _mak_to_none.diff.before.paths | length == 1
          - _mak_to_none.diff.before.paths[0] == ""
        fail_msg: The MAK To None previous output is not as expected.
        success_msg: The MAK To None previous output is as expected.

    - name: Verify MAK To None output
      ansible.builtin.assert:
        that:
          - _mak_to_none.task_sequence is defined
          - _mak_to_none.task_sequence.id == "MAK-NONE"
          - _mak_to_none.task_sequence.name == "MAK To None"
          - _mak_to_none.task_sequence.template == "Client.xml"
          - _mak_to_none.task_sequence.product_key_type == "none"
          - _mak_to_none.task_sequence.product_key is not defined
          - _mak_to_none.task_sequence.admin_password is not defined
          - _mak_to_none.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_none.task_sequence.full_name == "Test User"
          - _mak_to_none.task_sequence.organization == "Test Organization"
          - _mak_to_none.task_sequence.ie_home_page == "about:blank"
          - _mak_to_none.task_sequence.version == "1.0"
          - _mak_to_none.task_sequence.comments == ""
          - _mak_to_none.task_sequence.enabled
          - not _mak_to_none.task_sequence.hidden
          - _mak_to_none.task_sequence.paths is defined
          - _mak_to_none.task_sequence.paths | length == 1
          - _mak_to_none.task_sequence.paths[0] == ""
        fail_msg: The MAK To None output is not as expected.
        success_msg: The MAK To None output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _mak_to_none_check.changed == _mak_to_none.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check MAK To None secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: MAK-NONE
        include_secrets: true
      register: _mak_to_none_secrets

    - name: Verify MAK To None secrets
      ansible.builtin.assert:
        that:
          - _mak_to_none_secrets.task_sequence is defined
          - _mak_to_none_secrets.task_sequence.product_key_type == "none"
          - _mak_to_none_secrets.task_sequence.product_key is not defined
          - _mak_to_none_secrets.task_sequence.admin_password is not defined
        fail_msg: The MAK To None secrets are not as expected.
        success_msg: The MAK To None secrets are as expected.

    - name: Change product key from MAK to retail (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-RETAIL
        name: MAK To Retail
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_to_retail_check

    - name: Verify MAK To Retail previous output # noqa no-handler
      when:
        - _mak_to_retail_check is changed
      ansible.builtin.assert:
        that:
          - _mak_to_retail_check.diff.before != None
          - _mak_to_retail_check.diff.before.id == "MAK-RETAIL"
          - _mak_to_retail_check.diff.before.name == "MAK To Retail"
          - _mak_to_retail_check.diff.before.template == "Client.xml"
          - _mak_to_retail_check.diff.before.product_key_type == "mak"
          - _mak_to_retail_check.diff.before.product_key is not defined
          - _mak_to_retail_check.diff.before.admin_password is not defined
          - _mak_to_retail_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_retail_check.diff.before.full_name == "Test User"
          - _mak_to_retail_check.diff.before.organization == "Test Organization"
          - _mak_to_retail_check.diff.before.ie_home_page == "about:blank"
          - _mak_to_retail_check.diff.before.version == "1.0"
          - _mak_to_retail_check.diff.before.comments == ""
          - _mak_to_retail_check.diff.before.enabled
          - not _mak_to_retail_check.diff.before.hidden
          - _mak_to_retail_check.diff.before.paths is defined
          - _mak_to_retail_check.diff.before.paths | length == 1
          - _mak_to_retail_check.diff.before.paths[0] == ""
        fail_msg: The MAK To Retail previous output is not as expected.
        success_msg: The MAK To Retail previous output is as expected.

    - name: Verify MAK To Retail output
      ansible.builtin.assert:
        that:
          - _mak_to_retail_check.task_sequence is defined
          - _mak_to_retail_check.task_sequence.id == "MAK-RETAIL"
          - _mak_to_retail_check.task_sequence.name == "MAK To Retail"
          - _mak_to_retail_check.task_sequence.template == "Client.xml"
          - _mak_to_retail_check.task_sequence.product_key_type == "retail"
          - _mak_to_retail_check.task_sequence.product_key is not defined
          - _mak_to_retail_check.task_sequence.admin_password is not defined
          - _mak_to_retail_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_retail_check.task_sequence.full_name == "Test User"
          - _mak_to_retail_check.task_sequence.organization == "Test Organization"
          - _mak_to_retail_check.task_sequence.ie_home_page == "about:blank"
          - _mak_to_retail_check.task_sequence.version == "1.0"
          - _mak_to_retail_check.task_sequence.comments == ""
          - _mak_to_retail_check.task_sequence.enabled
          - not _mak_to_retail_check.task_sequence.hidden
          - _mak_to_retail_check.task_sequence.paths is defined
          - _mak_to_retail_check.task_sequence.paths | length == 1
          - _mak_to_retail_check.task_sequence.paths[0] == ""
        fail_msg: The MAK To Retail output is not as expected.
        success_msg: The MAK To Retail output is as expected.

    - name: Change product key from MAK to retail
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-RETAIL
        name: MAK To Retail
        template: Client.xml
        product_key_type: retail
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _mak_to_retail

    - name: Verify MAK To Retail previous output # noqa no-handler
      when:
        - _mak_to_retail is changed
      ansible.builtin.assert:
        that:
          - _mak_to_retail.diff.before != None
          - _mak_to_retail.diff.before.id == "MAK-RETAIL"
          - _mak_to_retail.diff.before.name == "MAK To Retail"
          - _mak_to_retail.diff.before.template == "Client.xml"
          - _mak_to_retail.diff.before.product_key_type == "mak"
          - _mak_to_retail.diff.before.product_key is not defined
          - _mak_to_retail.diff.before.admin_password is not defined
          - _mak_to_retail.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_retail.diff.before.full_name == "Test User"
          - _mak_to_retail.diff.before.organization == "Test Organization"
          - _mak_to_retail.diff.before.ie_home_page == "about:blank"
          - _mak_to_retail.diff.before.version == "1.0"
          - _mak_to_retail.diff.before.comments == ""
          - _mak_to_retail.diff.before.enabled
          - not _mak_to_retail.diff.before.hidden
          - _mak_to_retail.diff.before.paths is defined
          - _mak_to_retail.diff.before.paths | length == 1
          - _mak_to_retail.diff.before.paths[0] == ""
        fail_msg: The MAK To Retail previous output is not as expected.
        success_msg: The MAK To Retail previous output is as expected.

    - name: Verify MAK To Retail output
      ansible.builtin.assert:
        that:
          - _mak_to_retail.task_sequence is defined
          - _mak_to_retail.task_sequence.id == "MAK-RETAIL"
          - _mak_to_retail.task_sequence.name == "MAK To Retail"
          - _mak_to_retail.task_sequence.template == "Client.xml"
          - _mak_to_retail.task_sequence.product_key_type == "retail"
          - _mak_to_retail.task_sequence.product_key is not defined
          - _mak_to_retail.task_sequence.admin_password is not defined
          - _mak_to_retail.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _mak_to_retail.task_sequence.full_name == "Test User"
          - _mak_to_retail.task_sequence.organization == "Test Organization"
          - _mak_to_retail.task_sequence.ie_home_page == "about:blank"
          - _mak_to_retail.task_sequence.version == "1.0"
          - _mak_to_retail.task_sequence.comments == ""
          - _mak_to_retail.task_sequence.enabled
          - not _mak_to_retail.task_sequence.hidden
          - _mak_to_retail.task_sequence.paths is defined
          - _mak_to_retail.task_sequence.paths | length == 1
          - _mak_to_retail.task_sequence.paths[0] == ""
        fail_msg: The MAK To Retail output is not as expected.
        success_msg: The MAK To Retail output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _mak_to_retail_check.changed == _mak_to_retail.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check MAK To Retail secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: MAK-RETAIL
        include_secrets: true
      register: _mak_to_retail_secrets

    - name: Verify MAK To Retail secrets
      ansible.builtin.assert:
        that:
          - _mak_to_retail_secrets.task_sequence is defined
          - _mak_to_retail_secrets.task_sequence.product_key_type == "retail"
          - _mak_to_retail_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _mak_to_retail_secrets.task_sequence.admin_password is not defined
        fail_msg: The MAK To Retail secrets are not as expected.
        success_msg: The MAK To Retail secrets are as expected.

    - name: Change product key from retail to none (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NONE
        name: Retail To None
        template: Client.xml
        product_key_type: none
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_to_none_check

    - name: Verify Retail To None previous output # noqa no-handler
      when:
        - _retail_to_none_check is changed
      ansible.builtin.assert:
        that:
          - _retail_to_none_check.diff.before != None
          - _retail_to_none_check.diff.before.id == "RETAIL-NONE"
          - _retail_to_none_check.diff.before.name == "Retail To None"
          - _retail_to_none_check.diff.before.template == "Client.xml"
          - _retail_to_none_check.diff.before.product_key_type == "retail"
          - _retail_to_none_check.diff.before.product_key is not defined
          - _retail_to_none_check.diff.before.admin_password is not defined
          - _retail_to_none_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_none_check.diff.before.full_name == "Test User"
          - _retail_to_none_check.diff.before.organization == "Test Organization"
          - _retail_to_none_check.diff.before.ie_home_page == "about:blank"
          - _retail_to_none_check.diff.before.version == "1.0"
          - _retail_to_none_check.diff.before.comments == ""
          - _retail_to_none_check.diff.before.enabled
          - not _retail_to_none_check.diff.before.hidden
          - _retail_to_none_check.diff.before.paths is defined
          - _retail_to_none_check.diff.before.paths | length == 1
          - _retail_to_none_check.diff.before.paths[0] == ""
        fail_msg: The Retail To None previous output is not as expected.
        success_msg: The Retail To None previous output is as expected.

    - name: Verify Retail To None output
      ansible.builtin.assert:
        that:
          - _retail_to_none_check.task_sequence is defined
          - _retail_to_none_check.task_sequence.id == "RETAIL-NONE"
          - _retail_to_none_check.task_sequence.name == "Retail To None"
          - _retail_to_none_check.task_sequence.template == "Client.xml"
          - _retail_to_none_check.task_sequence.product_key_type == "none"
          - _retail_to_none_check.task_sequence.product_key is not defined
          - _retail_to_none_check.task_sequence.admin_password is not defined
          - _retail_to_none_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_none_check.task_sequence.full_name == "Test User"
          - _retail_to_none_check.task_sequence.organization == "Test Organization"
          - _retail_to_none_check.task_sequence.ie_home_page == "about:blank"
          - _retail_to_none_check.task_sequence.version == "1.0"
          - _retail_to_none_check.task_sequence.comments == ""
          - _retail_to_none_check.task_sequence.enabled
          - not _retail_to_none_check.task_sequence.hidden
          - _retail_to_none_check.task_sequence.paths is defined
          - _retail_to_none_check.task_sequence.paths | length == 1
          - _retail_to_none_check.task_sequence.paths[0] == ""
        fail_msg: The Retail To None output is not as expected.
        success_msg: The Retail To None output is as expected.

    - name: Change product key from retail to none
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NONE
        name: Retail To None
        template: Client.xml
        product_key_type: none
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_to_none

    - name: Verify Retail To None previous output # noqa no-handler
      when:
        - _retail_to_none is changed
      ansible.builtin.assert:
        that:
          - _retail_to_none.diff.before != None
          - _retail_to_none.diff.before.id == "RETAIL-NONE"
          - _retail_to_none.diff.before.name == "Retail To None"
          - _retail_to_none.diff.before.template == "Client.xml"
          - _retail_to_none.diff.before.product_key_type == "retail"
          - _retail_to_none.diff.before.product_key is not defined
          - _retail_to_none.diff.before.admin_password is not defined
          - _retail_to_none.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_none.diff.before.full_name == "Test User"
          - _retail_to_none.diff.before.organization == "Test Organization"
          - _retail_to_none.diff.before.ie_home_page == "about:blank"
          - _retail_to_none.diff.before.version == "1.0"
          - _retail_to_none.diff.before.comments == ""
          - _retail_to_none.diff.before.enabled
          - not _retail_to_none.diff.before.hidden
          - _retail_to_none.diff.before.paths is defined
          - _retail_to_none.diff.before.paths | length == 1
          - _retail_to_none.diff.before.paths[0] == ""
        fail_msg: The Retail To None previous output is not as expected.
        success_msg: The Retail To None previous output is as expected.

    - name: Verify Retail To None output
      ansible.builtin.assert:
        that:
          - _retail_to_none.task_sequence is defined
          - _retail_to_none.task_sequence.id == "RETAIL-NONE"
          - _retail_to_none.task_sequence.name == "Retail To None"
          - _retail_to_none.task_sequence.template == "Client.xml"
          - _retail_to_none.task_sequence.product_key_type == "none"
          - _retail_to_none.task_sequence.product_key is not defined
          - _retail_to_none.task_sequence.admin_password is not defined
          - _retail_to_none.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_none.task_sequence.full_name == "Test User"
          - _retail_to_none.task_sequence.organization == "Test Organization"
          - _retail_to_none.task_sequence.ie_home_page == "about:blank"
          - _retail_to_none.task_sequence.version == "1.0"
          - _retail_to_none.task_sequence.comments == ""
          - _retail_to_none.task_sequence.enabled
          - not _retail_to_none.task_sequence.hidden
          - _retail_to_none.task_sequence.paths is defined
          - _retail_to_none.task_sequence.paths | length == 1
          - _retail_to_none.task_sequence.paths[0] == ""
        fail_msg: The Retail To None output is not as expected.
        success_msg: The Retail To None output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _retail_to_none_check.changed == _retail_to_none.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Retail To None secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: RETAIL-NONE
        include_secrets: true
      register: _retail_to_none_secrets

    - name: Verify Retail To None secrets
      ansible.builtin.assert:
        that:
          - _retail_to_none_secrets.task_sequence is defined
          - _retail_to_none_secrets.task_sequence.product_key_type == "none"
          - _retail_to_none_secrets.task_sequence.product_key is not defined
          - _retail_to_none_secrets.task_sequence.admin_password is not defined
        fail_msg: The Retail To None secrets are not as expected.
        success_msg: The Retail To None secrets are as expected.

    - name: Change product key from retail to MAK (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-MAK
        name: Retail To MAK
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_to_change_mak_key_check

    - name: Verify Retail To MAK previous output # noqa no-handler
      when:
        - _retail_to_change_mak_key_check is changed
      ansible.builtin.assert:
        that:
          - _retail_to_change_mak_key_check.diff.before != None
          - _retail_to_change_mak_key_check.diff.before.id == "RETAIL-MAK"
          - _retail_to_change_mak_key_check.diff.before.name == "Retail To MAK"
          - _retail_to_change_mak_key_check.diff.before.template == "Client.xml"
          - _retail_to_change_mak_key_check.diff.before.product_key_type == "retail"
          - _retail_to_change_mak_key_check.diff.before.product_key is not defined
          - _retail_to_change_mak_key_check.diff.before.admin_password is not defined
          - _retail_to_change_mak_key_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_change_mak_key_check.diff.before.full_name == "Test User"
          - _retail_to_change_mak_key_check.diff.before.organization == "Test Organization"
          - _retail_to_change_mak_key_check.diff.before.ie_home_page == "about:blank"
          - _retail_to_change_mak_key_check.diff.before.version == "1.0"
          - _retail_to_change_mak_key_check.diff.before.comments == ""
          - _retail_to_change_mak_key_check.diff.before.enabled
          - not _retail_to_change_mak_key_check.diff.before.hidden
          - _retail_to_change_mak_key_check.diff.before.paths is defined
          - _retail_to_change_mak_key_check.diff.before.paths | length == 1
          - _retail_to_change_mak_key_check.diff.before.paths[0] == ""
        fail_msg: The Retail To MAK previous output is not as expected.
        success_msg: The Retail To MAK previous output is as expected.

    - name: Verify Retail To MAK output
      ansible.builtin.assert:
        that:
          - _retail_to_change_mak_key_check.task_sequence is defined
          - _retail_to_change_mak_key_check.task_sequence.id == "RETAIL-MAK"
          - _retail_to_change_mak_key_check.task_sequence.name == "Retail To MAK"
          - _retail_to_change_mak_key_check.task_sequence.template == "Client.xml"
          - _retail_to_change_mak_key_check.task_sequence.product_key_type == "mak"
          - _retail_to_change_mak_key_check.task_sequence.product_key is not defined
          - _retail_to_change_mak_key_check.task_sequence.admin_password is not defined
          - _retail_to_change_mak_key_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_change_mak_key_check.task_sequence.full_name == "Test User"
          - _retail_to_change_mak_key_check.task_sequence.organization == "Test Organization"
          - _retail_to_change_mak_key_check.task_sequence.ie_home_page == "about:blank"
          - _retail_to_change_mak_key_check.task_sequence.version == "1.0"
          - _retail_to_change_mak_key_check.task_sequence.comments == ""
          - _retail_to_change_mak_key_check.task_sequence.enabled
          - not _retail_to_change_mak_key_check.task_sequence.hidden
          - _retail_to_change_mak_key_check.task_sequence.paths is defined
          - _retail_to_change_mak_key_check.task_sequence.paths | length == 1
          - _retail_to_change_mak_key_check.task_sequence.paths[0] == ""
        fail_msg: The Retail To MAK output is not as expected.
        success_msg: The Retail To MAK output is as expected.

    - name: Change product key from retail to MAK
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-MAK
        name: Retail To MAK
        template: Client.xml
        product_key_type: mak
        product_key: XXXXX-XXXXX-XXXXX-XXXXX-XXXXX
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _retail_to_mak

    - name: Verify Retail To MAK previous output # noqa no-handler
      when:
        - _retail_to_mak is changed
      ansible.builtin.assert:
        that:
          - _retail_to_mak.diff.before != None
          - _retail_to_mak.diff.before.id == "RETAIL-MAK"
          - _retail_to_mak.diff.before.name == "Retail To MAK"
          - _retail_to_mak.diff.before.template == "Client.xml"
          - _retail_to_mak.diff.before.product_key_type == "retail"
          - _retail_to_mak.diff.before.product_key is not defined
          - _retail_to_mak.diff.before.admin_password is not defined
          - _retail_to_mak.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_mak.diff.before.full_name == "Test User"
          - _retail_to_mak.diff.before.organization == "Test Organization"
          - _retail_to_mak.diff.before.ie_home_page == "about:blank"
          - _retail_to_mak.diff.before.version == "1.0"
          - _retail_to_mak.diff.before.comments == ""
          - _retail_to_mak.diff.before.enabled
          - not _retail_to_mak.diff.before.hidden
          - _retail_to_mak.diff.before.paths is defined
          - _retail_to_mak.diff.before.paths | length == 1
          - _retail_to_mak.diff.before.paths[0] == ""
        fail_msg: The Retail To MAK previous output is not as expected.
        success_msg: The Retail To MAK previous output is as expected.

    - name: Verify Retail To MAK output
      ansible.builtin.assert:
        that:
          - _retail_to_mak.task_sequence is defined
          - _retail_to_mak.task_sequence.id == "RETAIL-MAK"
          - _retail_to_mak.task_sequence.name == "Retail To MAK"
          - _retail_to_mak.task_sequence.template == "Client.xml"
          - _retail_to_mak.task_sequence.product_key_type == "mak"
          - _retail_to_mak.task_sequence.product_key is not defined
          - _retail_to_mak.task_sequence.admin_password is not defined
          - _retail_to_mak.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _retail_to_mak.task_sequence.full_name == "Test User"
          - _retail_to_mak.task_sequence.organization == "Test Organization"
          - _retail_to_mak.task_sequence.ie_home_page == "about:blank"
          - _retail_to_mak.task_sequence.version == "1.0"
          - _retail_to_mak.task_sequence.comments == ""
          - _retail_to_mak.task_sequence.enabled
          - not _retail_to_mak.task_sequence.hidden
          - _retail_to_mak.task_sequence.paths is defined
          - _retail_to_mak.task_sequence.paths | length == 1
          - _retail_to_mak.task_sequence.paths[0] == ""
        fail_msg: The Retail To MAK output is not as expected.
        success_msg: The Retail To MAK output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _retail_to_change_mak_key_check.changed == _retail_to_mak.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Retail To MAK secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: RETAIL-MAK
        include_secrets: true
      register: _retail_to_mak_secrets

    - name: Verify Retail To MAK secrets
      ansible.builtin.assert:
        that:
          - _retail_to_mak_secrets.task_sequence is defined
          - _retail_to_mak_secrets.task_sequence.product_key_type == "mak"
          - _retail_to_mak_secrets.task_sequence.product_key == "XXXXX-XXXXX-XXXXX-XXXXX-XXXXX"
          - _retail_to_mak_secrets.task_sequence.admin_password is not defined
        fail_msg: The Retail To MAK secrets are not as expected.
        success_msg: The Retail To MAK secrets are as expected.

    - name: Change MAK product key (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-KEY
        name: Change MAK Key
        template: Client.xml
        product_key_type: mak
        product_key: YYYYY-YYYYY-YYYYY-YYYYY-YYYYY
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_mak_key_check

    - name: Verify Change MAK Key previous output # noqa no-handler
      when:
        - _change_mak_key_check is changed
      ansible.builtin.assert:
        that:
          - _change_mak_key_check.diff.before != None
          - _change_mak_key_check.diff.before.id == "MAK-KEY"
          - _change_mak_key_check.diff.before.name == "Change MAK Key"
          - _change_mak_key_check.diff.before.template == "Client.xml"
          - _change_mak_key_check.diff.before.product_key_type == "mak"
          - _change_mak_key_check.diff.before.product_key is not defined
          - _change_mak_key_check.diff.before.admin_password is not defined
          - _change_mak_key_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_mak_key_check.diff.before.full_name == "Test User"
          - _change_mak_key_check.diff.before.organization == "Test Organization"
          - _change_mak_key_check.diff.before.ie_home_page == "about:blank"
          - _change_mak_key_check.diff.before.version == "1.0"
          - _change_mak_key_check.diff.before.comments == ""
          - _change_mak_key_check.diff.before.enabled
          - not _change_mak_key_check.diff.before.hidden
          - _change_mak_key_check.diff.before.paths is defined
          - _change_mak_key_check.diff.before.paths | length == 1
          - _change_mak_key_check.diff.before.paths[0] == ""
        fail_msg: The Change MAK Key previous output is not as expected.
        success_msg: The Change MAK Key previous output is as expected.

    - name: Verify Change MAK Key output
      ansible.builtin.assert:
        that:
          - _change_mak_key_check.task_sequence is defined
          - _change_mak_key_check.task_sequence.id == "MAK-KEY"
          - _change_mak_key_check.task_sequence.name == "Change MAK Key"
          - _change_mak_key_check.task_sequence.template == "Client.xml"
          - _change_mak_key_check.task_sequence.product_key_type == "mak"
          - _change_mak_key_check.task_sequence.product_key is not defined
          - _change_mak_key_check.task_sequence.admin_password is not defined
          - _change_mak_key_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_mak_key_check.task_sequence.full_name == "Test User"
          - _change_mak_key_check.task_sequence.organization == "Test Organization"
          - _change_mak_key_check.task_sequence.ie_home_page == "about:blank"
          - _change_mak_key_check.task_sequence.version == "1.0"
          - _change_mak_key_check.task_sequence.comments == ""
          - _change_mak_key_check.task_sequence.enabled
          - not _change_mak_key_check.task_sequence.hidden
          - _change_mak_key_check.task_sequence.paths is defined
          - _change_mak_key_check.task_sequence.paths | length == 1
          - _change_mak_key_check.task_sequence.paths[0] == ""
        fail_msg: The Change MAK Key output is not as expected.
        success_msg: The Change MAK Key output is as expected.

    - name: Change Change MAK Key product key
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: MAK-KEY
        name: Change MAK Key
        template: Client.xml
        product_key_type: mak
        product_key: YYYYY-YYYYY-YYYYY-YYYYY-YYYYY
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_mak_key

    - name: Verify Change MAK Key previous output # noqa no-handler
      when:
        - _change_mak_key is changed
      ansible.builtin.assert:
        that:
          - _change_mak_key.diff.before != None
          - _change_mak_key.diff.before.id == "MAK-KEY"
          - _change_mak_key.diff.before.name == "Change MAK Key"
          - _change_mak_key.diff.before.template == "Client.xml"
          - _change_mak_key.diff.before.product_key_type == "mak"
          - _change_mak_key.diff.before.product_key is not defined
          - _change_mak_key.diff.before.admin_password is not defined
          - _change_mak_key.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_mak_key.diff.before.full_name == "Test User"
          - _change_mak_key.diff.before.organization == "Test Organization"
          - _change_mak_key.diff.before.ie_home_page == "about:blank"
          - _change_mak_key.diff.before.version == "1.0"
          - _change_mak_key.diff.before.comments == ""
          - _change_mak_key.diff.before.enabled
          - not _change_mak_key.diff.before.hidden
          - _change_mak_key.diff.before.paths is defined
          - _change_mak_key.diff.before.paths | length == 1
          - _change_mak_key.diff.before.paths[0] == ""
        fail_msg: The Change MAK Key previous output is not as expected.
        success_msg: The Change MAK Key previous output is as expected.

    - name: Verify Change MAK Key output
      ansible.builtin.assert:
        that:
          - _change_mak_key.task_sequence is defined
          - _change_mak_key.task_sequence.id == "MAK-KEY"
          - _change_mak_key.task_sequence.name == "Change MAK Key"
          - _change_mak_key.task_sequence.template == "Client.xml"
          - _change_mak_key.task_sequence.product_key_type == "mak"
          - _change_mak_key.task_sequence.product_key is not defined
          - _change_mak_key.task_sequence.admin_password is not defined
          - _change_mak_key.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_mak_key.task_sequence.full_name == "Test User"
          - _change_mak_key.task_sequence.organization == "Test Organization"
          - _change_mak_key.task_sequence.ie_home_page == "about:blank"
          - _change_mak_key.task_sequence.version == "1.0"
          - _change_mak_key.task_sequence.comments == ""
          - _change_mak_key.task_sequence.enabled
          - not _change_mak_key.task_sequence.hidden
          - _change_mak_key.task_sequence.paths is defined
          - _change_mak_key.task_sequence.paths | length == 1
          - _change_mak_key.task_sequence.paths[0] == ""
        fail_msg: The Change MAK Key output is not as expected.
        success_msg: The Change MAK Key output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_mak_key_check.changed == _change_mak_key.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Change MAK Key secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: MAK-KEY
        include_secrets: true
      register: _change_mak_key_secrets

    - name: Verify Change MAK Key secrets
      ansible.builtin.assert:
        that:
          - _change_mak_key_secrets.task_sequence is defined
          - _change_mak_key_secrets.task_sequence.product_key_type == "mak"
          - _change_mak_key_secrets.task_sequence.product_key == "YYYYY-YYYYY-YYYYY-YYYYY-YYYYY"
          - _change_mak_key_secrets.task_sequence.admin_password is not defined
        fail_msg: The Change MAK Key secrets are not as expected.
        success_msg: The Change MAK Key secrets are as expected.

    - name: Change retail product key (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-KEY
        name: Change Retail Key
        template: Client.xml
        product_key_type: retail
        product_key: YYYYY-YYYYY-YYYYY-YYYYY-YYYYY
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_retail_key_check

    - name: Verify Change Retail Key previous output # noqa no-handler
      when:
        - _change_retail_key_check is changed
      ansible.builtin.assert:
        that:
          - _change_retail_key_check.diff.before != None
          - _change_retail_key_check.diff.before.id == "RETAIL-KEY"
          - _change_retail_key_check.diff.before.name == "Change Retail Key"
          - _change_retail_key_check.diff.before.template == "Client.xml"
          - _change_retail_key_check.diff.before.product_key_type == "retail"
          - _change_retail_key_check.diff.before.product_key is not defined
          - _change_retail_key_check.diff.before.admin_password is not defined
          - _change_retail_key_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_retail_key_check.diff.before.full_name == "Test User"
          - _change_retail_key_check.diff.before.organization == "Test Organization"
          - _change_retail_key_check.diff.before.ie_home_page == "about:blank"
          - _change_retail_key_check.diff.before.version == "1.0"
          - _change_retail_key_check.diff.before.comments == ""
          - _change_retail_key_check.diff.before.enabled
          - not _change_retail_key_check.diff.before.hidden
          - _change_retail_key_check.diff.before.paths is defined
          - _change_retail_key_check.diff.before.paths | length == 1
          - _change_retail_key_check.diff.before.paths[0] == ""
        fail_msg: The Change Retail Key previous output is not as expected.
        success_msg: The Change Retail Key previous output is as expected.

    - name: Verify Change Retail Key output
      ansible.builtin.assert:
        that:
          - _change_retail_key_check.task_sequence is defined
          - _change_retail_key_check.task_sequence.id == "RETAIL-KEY"
          - _change_retail_key_check.task_sequence.name == "Change Retail Key"
          - _change_retail_key_check.task_sequence.template == "Client.xml"
          - _change_retail_key_check.task_sequence.product_key_type == "retail"
          - _change_retail_key_check.task_sequence.product_key is not defined
          - _change_retail_key_check.task_sequence.admin_password is not defined
          - _change_retail_key_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_retail_key_check.task_sequence.full_name == "Test User"
          - _change_retail_key_check.task_sequence.organization == "Test Organization"
          - _change_retail_key_check.task_sequence.ie_home_page == "about:blank"
          - _change_retail_key_check.task_sequence.version == "1.0"
          - _change_retail_key_check.task_sequence.comments == ""
          - _change_retail_key_check.task_sequence.enabled
          - not _change_retail_key_check.task_sequence.hidden
          - _change_retail_key_check.task_sequence.paths is defined
          - _change_retail_key_check.task_sequence.paths | length == 1
          - _change_retail_key_check.task_sequence.paths[0] == ""
        fail_msg: The Change Retail Key output is not as expected.
        success_msg: The Change Retail Key output is as expected.

    - name: Change Change Retail Key product key
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RETAIL-KEY
        name: Change Retail Key
        template: Client.xml
        product_key_type: retail
        product_key: YYYYY-YYYYY-YYYYY-YYYYY-YYYYY
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_retail_key

    - name: Verify Change Retail Key previous output # noqa no-handler
      when:
        - _change_retail_key is changed
      ansible.builtin.assert:
        that:
          - _change_retail_key.diff.before != None
          - _change_retail_key.diff.before.id == "RETAIL-KEY"
          - _change_retail_key.diff.before.name == "Change Retail Key"
          - _change_retail_key.diff.before.template == "Client.xml"
          - _change_retail_key.diff.before.product_key_type == "retail"
          - _change_retail_key.diff.before.product_key is not defined
          - _change_retail_key.diff.before.admin_password is not defined
          - _change_retail_key.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_retail_key.diff.before.full_name == "Test User"
          - _change_retail_key.diff.before.organization == "Test Organization"
          - _change_retail_key.diff.before.ie_home_page == "about:blank"
          - _change_retail_key.diff.before.version == "1.0"
          - _change_retail_key.diff.before.comments == ""
          - _change_retail_key.diff.before.enabled
          - not _change_retail_key.diff.before.hidden
          - _change_retail_key.diff.before.paths is defined
          - _change_retail_key.diff.before.paths | length == 1
          - _change_retail_key.diff.before.paths[0] == ""
        fail_msg: The Change Retail Key previous output is not as expected.
        success_msg: The Change Retail Key previous output is as expected.

    - name: Verify Change Retail Key output
      ansible.builtin.assert:
        that:
          - _change_retail_key.task_sequence is defined
          - _change_retail_key.task_sequence.id == "RETAIL-KEY"
          - _change_retail_key.task_sequence.name == "Change Retail Key"
          - _change_retail_key.task_sequence.template == "Client.xml"
          - _change_retail_key.task_sequence.product_key_type == "retail"
          - _change_retail_key.task_sequence.product_key is not defined
          - _change_retail_key.task_sequence.admin_password is not defined
          - _change_retail_key.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_retail_key.task_sequence.full_name == "Test User"
          - _change_retail_key.task_sequence.organization == "Test Organization"
          - _change_retail_key.task_sequence.ie_home_page == "about:blank"
          - _change_retail_key.task_sequence.version == "1.0"
          - _change_retail_key.task_sequence.comments == ""
          - _change_retail_key.task_sequence.enabled
          - not _change_retail_key.task_sequence.hidden
          - _change_retail_key.task_sequence.paths is defined
          - _change_retail_key.task_sequence.paths | length == 1
          - _change_retail_key.task_sequence.paths[0] == ""
        fail_msg: The Change Retail Key output is not as expected.
        success_msg: The Change Retail Key output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_retail_key_check.changed == _change_retail_key.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Change Retail Key secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: RETAIL-KEY
        include_secrets: true
      register: _change_retail_key_secrets

    - name: Verify Change Retail Key secrets
      ansible.builtin.assert:
        that:
          - _change_retail_key_secrets.task_sequence is defined
          - _change_retail_key_secrets.task_sequence.product_key_type == "retail"
          - _change_retail_key_secrets.task_sequence.product_key == "YYYYY-YYYYY-YYYYY-YYYYY-YYYYY"
          - _change_retail_key_secrets.task_sequence.admin_password is not defined
        fail_msg: The Change Retail Key secrets are not as expected.
        success_msg: The Change Retail Key secrets are as expected.

    - name: Change operating system (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: OS-NAME
        name: Change OS
        template: Client.xml
        operating_system_name: Windows 11 Pro
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_os_check

    - name: Verify Change OS previous output # noqa no-handler
      when:
        - _change_os_check is changed
      ansible.builtin.assert:
        that:
          - _change_os_check.diff.before != None
          - _change_os_check.diff.before.id == "OS-NAME"
          - _change_os_check.diff.before.name == "Change OS"
          - _change_os_check.diff.before.template == "Client.xml"
          - _change_os_check.diff.before.product_key_type == "none"
          - _change_os_check.diff.before.product_key is not defined
          - _change_os_check.diff.before.admin_password is not defined
          - _change_os_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_os_check.diff.before.full_name == "Test User"
          - _change_os_check.diff.before.organization == "Test Organization"
          - _change_os_check.diff.before.ie_home_page == "about:blank"
          - _change_os_check.diff.before.version == "1.0"
          - _change_os_check.diff.before.comments == ""
          - _change_os_check.diff.before.enabled
          - not _change_os_check.diff.before.hidden
          - _change_os_check.diff.before.paths is defined
          - _change_os_check.diff.before.paths | length == 1
          - _change_os_check.diff.before.paths[0] == ""
        fail_msg: The Change OS previous output is not as expected.
        success_msg: The Change OS previous output is as expected.

    - name: Verify Change OS output
      ansible.builtin.assert:
        that:
          - _change_os_check.task_sequence is defined
          - _change_os_check.task_sequence.id == "OS-NAME"
          - _change_os_check.task_sequence.name == "Change OS"
          - _change_os_check.task_sequence.template == "Client.xml"
          - _change_os_check.task_sequence.product_key_type == "none"
          - _change_os_check.task_sequence.product_key is not defined
          - _change_os_check.task_sequence.admin_password is not defined
          - _change_os_check.task_sequence.operating_system.name == "Windows 11 Pro"
          - _change_os_check.task_sequence.full_name == "Test User"
          - _change_os_check.task_sequence.organization == "Test Organization"
          - _change_os_check.task_sequence.ie_home_page == "about:blank"
          - _change_os_check.task_sequence.version == "1.0"
          - _change_os_check.task_sequence.comments == ""
          - _change_os_check.task_sequence.enabled
          - not _change_os_check.task_sequence.hidden
          - _change_os_check.task_sequence.paths is defined
          - _change_os_check.task_sequence.paths | length == 1
          - _change_os_check.task_sequence.paths[0] == ""
        fail_msg: The Change OS output is not as expected.
        success_msg: The Change OS output is as expected.

    - name: Change operating system
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: OS-NAME
        name: Change OS
        template: Client.xml
        operating_system_name: Windows 11 Pro
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_os

    - name: Verify Change OS previous output # noqa no-handler
      when:
        - _change_os is changed
      ansible.builtin.assert:
        that:
          - _change_os.diff.before != None
          - _change_os.diff.before.id == "OS-NAME"
          - _change_os.diff.before.name == "Change OS"
          - _change_os.diff.before.template == "Client.xml"
          - _change_os.diff.before.product_key_type == "none"
          - _change_os.diff.before.product_key is not defined
          - _change_os.diff.before.admin_password is not defined
          - _change_os.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_os.diff.before.full_name == "Test User"
          - _change_os.diff.before.organization == "Test Organization"
          - _change_os.diff.before.ie_home_page == "about:blank"
          - _change_os.diff.before.version == "1.0"
          - _change_os.diff.before.comments == ""
          - _change_os.diff.before.enabled
          - not _change_os.diff.before.hidden
          - _change_os.diff.before.paths is defined
          - _change_os.diff.before.paths | length == 1
          - _change_os.diff.before.paths[0] == ""
        fail_msg: The Change OS previous output is not as expected.
        success_msg: The Change OS previous output is as expected.

    - name: Verify Change OS output
      ansible.builtin.assert:
        that:
          - _change_os.task_sequence is defined
          - _change_os.task_sequence.id == "OS-NAME"
          - _change_os.task_sequence.name == "Change OS"
          - _change_os.task_sequence.template == "Client.xml"
          - _change_os.task_sequence.product_key_type == "none"
          - _change_os.task_sequence.product_key is not defined
          - _change_os.task_sequence.admin_password is not defined
          - _change_os.task_sequence.operating_system.name == "Windows 11 Pro"
          - _change_os.task_sequence.full_name == "Test User"
          - _change_os.task_sequence.organization == "Test Organization"
          - _change_os.task_sequence.ie_home_page == "about:blank"
          - _change_os.task_sequence.version == "1.0"
          - _change_os.task_sequence.comments == ""
          - _change_os.task_sequence.enabled
          - not _change_os.task_sequence.hidden
          - _change_os.task_sequence.paths is defined
          - _change_os.task_sequence.paths | length == 1
          - _change_os.task_sequence.paths[0] == ""
        fail_msg: The Change OS output is not as expected.
        success_msg: The Change OS output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_os_check.changed == _change_os.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change admin password from unset (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS1
        name: Change Admin Password
        template: Client.xml
        admin_password: SecurePassword123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password_check

    - name: Verify Change Admin Password previous output # noqa no-handler
      when:
        - _change_admin_password_check is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password_check.diff.before != None
          - _change_admin_password_check.diff.before.id == "ADMIN-PASS1"
          - _change_admin_password_check.diff.before.name == "Change Admin Password"
          - _change_admin_password_check.diff.before.template == "Client.xml"
          - _change_admin_password_check.diff.before.product_key_type == "none"
          - _change_admin_password_check.diff.before.product_key is not defined
          - _change_admin_password_check.diff.before.admin_password is not defined
          - _change_admin_password_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_check.diff.before.full_name == "Test User"
          - _change_admin_password_check.diff.before.organization == "Test Organization"
          - _change_admin_password_check.diff.before.ie_home_page == "about:blank"
          - _change_admin_password_check.diff.before.version == "1.0"
          - _change_admin_password_check.diff.before.comments == ""
          - _change_admin_password_check.diff.before.enabled
          - not _change_admin_password_check.diff.before.hidden
          - _change_admin_password_check.diff.before.paths is defined
          - _change_admin_password_check.diff.before.paths | length == 1
          - _change_admin_password_check.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password previous output is not as expected.
        success_msg: The Change Admin Password previous output is as expected.

    - name: Verify Change Admin Password output
      ansible.builtin.assert:
        that:
          - _change_admin_password_check.task_sequence is defined
          - _change_admin_password_check.task_sequence.id == "ADMIN-PASS1"
          - _change_admin_password_check.task_sequence.name == "Change Admin Password"
          - _change_admin_password_check.task_sequence.template == "Client.xml"
          - _change_admin_password_check.task_sequence.product_key_type == "none"
          - _change_admin_password_check.task_sequence.product_key is not defined
          - _change_admin_password_check.task_sequence.admin_password is not defined
          - _change_admin_password_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_check.task_sequence.full_name == "Test User"
          - _change_admin_password_check.task_sequence.organization == "Test Organization"
          - _change_admin_password_check.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password_check.task_sequence.version == "1.0"
          - _change_admin_password_check.task_sequence.comments == ""
          - _change_admin_password_check.task_sequence.enabled
          - not _change_admin_password_check.task_sequence.hidden
          - _change_admin_password_check.task_sequence.paths is defined
          - _change_admin_password_check.task_sequence.paths | length == 1
          - _change_admin_password_check.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password output is not as expected.
        success_msg: The Change Admin Password output is as expected.

    - name: Change admin password from unset
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS1
        name: Change Admin Password
        template: Client.xml
        admin_password: SecurePassword123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password

    - name: Verify Change Admin Password previous output # noqa no-handler
      when:
        - _change_admin_password is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password.diff.before != None
          - _change_admin_password.diff.before.id == "ADMIN-PASS1"
          - _change_admin_password.diff.before.name == "Change Admin Password"
          - _change_admin_password.diff.before.template == "Client.xml"
          - _change_admin_password.diff.before.product_key_type == "none"
          - _change_admin_password.diff.before.product_key is not defined
          - _change_admin_password.diff.before.admin_password is not defined
          - _change_admin_password.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password.diff.before.full_name == "Test User"
          - _change_admin_password.diff.before.organization == "Test Organization"
          - _change_admin_password.diff.before.ie_home_page == "about:blank"
          - _change_admin_password.diff.before.version == "1.0"
          - _change_admin_password.diff.before.comments == ""
          - _change_admin_password.diff.before.enabled
          - not _change_admin_password.diff.before.hidden
          - _change_admin_password.diff.before.paths is defined
          - _change_admin_password.diff.before.paths | length == 1
          - _change_admin_password.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password previous output is not as expected.
        success_msg: The Change Admin Password previous output is as expected.

    - name: Verify Change Admin Password output
      ansible.builtin.assert:
        that:
          - _change_admin_password.task_sequence is defined
          - _change_admin_password.task_sequence.id == "ADMIN-PASS1"
          - _change_admin_password.task_sequence.name == "Change Admin Password"
          - _change_admin_password.task_sequence.template == "Client.xml"
          - _change_admin_password.task_sequence.product_key_type == "none"
          - _change_admin_password.task_sequence.product_key is not defined
          - _change_admin_password.task_sequence.admin_password is not defined
          - _change_admin_password.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password.task_sequence.full_name == "Test User"
          - _change_admin_password.task_sequence.organization == "Test Organization"
          - _change_admin_password.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password.task_sequence.version == "1.0"
          - _change_admin_password.task_sequence.comments == ""
          - _change_admin_password.task_sequence.enabled
          - not _change_admin_password.task_sequence.hidden
          - _change_admin_password.task_sequence.paths is defined
          - _change_admin_password.task_sequence.paths | length == 1
          - _change_admin_password.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password output is not as expected.
        success_msg: The Change Admin Password output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_admin_password_check.changed == _change_admin_password.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Change Admin Password secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS1
        include_secrets: true
      register: _change_admin_password_secrets

    - name: Verify Change Admin Password secrets
      ansible.builtin.assert:
        that:
          - _change_admin_password_secrets.task_sequence is defined
          - _change_admin_password_secrets.task_sequence.product_key_type == "none"
          - _change_admin_password_secrets.task_sequence.product_key is not defined
          - _change_admin_password_secrets.task_sequence.admin_password == "SecurePassword123!"
        fail_msg: The Change Admin Password secrets are not as expected.
        success_msg: The Change Admin Password secrets are as expected.

    - name: Change admin password from previous (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS2
        name: Change Admin Password From Previous
        template: Client.xml
        admin_password: SecurePassword123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password_from_previous_check

    - name: Verify Change Admin Password From Previous previous output # noqa no-handler
      when:
        - _change_admin_password_from_previous_check is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous_check.diff.before != None
          - _change_admin_password_from_previous_check.diff.before.id == "ADMIN-PASS2"
          - _change_admin_password_from_previous_check.diff.before.name == "Change Admin Password From Previous"
          - _change_admin_password_from_previous_check.diff.before.template == "Client.xml"
          - _change_admin_password_from_previous_check.diff.before.product_key_type == "none"
          - _change_admin_password_from_previous_check.diff.before.product_key is not defined
          - _change_admin_password_from_previous_check.diff.before.admin_password is not defined
          - _change_admin_password_from_previous_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_from_previous_check.diff.before.full_name == "Test User"
          - _change_admin_password_from_previous_check.diff.before.organization == "Test Organization"
          - _change_admin_password_from_previous_check.diff.before.ie_home_page == "about:blank"
          - _change_admin_password_from_previous_check.diff.before.version == "1.0"
          - _change_admin_password_from_previous_check.diff.before.comments == ""
          - _change_admin_password_from_previous_check.diff.before.enabled
          - not _change_admin_password_from_previous_check.diff.before.hidden
          - _change_admin_password_from_previous_check.diff.before.paths is defined
          - _change_admin_password_from_previous_check.diff.before.paths | length == 1
          - _change_admin_password_from_previous_check.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password From Previous previous output is not as expected.
        success_msg: The Change Admin Password From Previous previous output is as expected.

    - name: Verify Change Admin Password From Previous output
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous_check.task_sequence is defined
          - _change_admin_password_from_previous_check.task_sequence.id == "ADMIN-PASS2"
          - _change_admin_password_from_previous_check.task_sequence.name == "Change Admin Password From Previous"
          - _change_admin_password_from_previous_check.task_sequence.template == "Client.xml"
          - _change_admin_password_from_previous_check.task_sequence.product_key_type == "none"
          - _change_admin_password_from_previous_check.task_sequence.product_key is not defined
          - _change_admin_password_from_previous_check.task_sequence.admin_password is not defined
          - _change_admin_password_from_previous_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_from_previous_check.task_sequence.full_name == "Test User"
          - _change_admin_password_from_previous_check.task_sequence.organization == "Test Organization"
          - _change_admin_password_from_previous_check.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password_from_previous_check.task_sequence.version == "1.0"
          - _change_admin_password_from_previous_check.task_sequence.comments == ""
          - _change_admin_password_from_previous_check.task_sequence.enabled
          - not _change_admin_password_from_previous_check.task_sequence.hidden
          - _change_admin_password_from_previous_check.task_sequence.paths is defined
          - _change_admin_password_from_previous_check.task_sequence.paths | length == 1
          - _change_admin_password_from_previous_check.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password From Previous output is not as expected.
        success_msg: The Change Admin Password From Previous output is as expected.

    - name: Change admin password from previous
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS2
        name: Change Admin Password From Previous
        template: Client.xml
        admin_password: SecurePassword123!
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password_from_previous

    - name: Verify Change Admin Password From Previous previous output # noqa no-handler
      when:
        - _change_admin_password_from_previous is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous.diff.before != None
          - _change_admin_password_from_previous.diff.before.id == "ADMIN-PASS2"
          - _change_admin_password_from_previous.diff.before.name == "Change Admin Password From Previous"
          - _change_admin_password_from_previous.diff.before.template == "Client.xml"
          - _change_admin_password_from_previous.diff.before.product_key_type == "none"
          - _change_admin_password_from_previous.diff.before.product_key is not defined
          - _change_admin_password_from_previous.diff.before.admin_password is not defined
          - _change_admin_password_from_previous.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_from_previous.diff.before.full_name == "Test User"
          - _change_admin_password_from_previous.diff.before.organization == "Test Organization"
          - _change_admin_password_from_previous.diff.before.ie_home_page == "about:blank"
          - _change_admin_password_from_previous.diff.before.version == "1.0"
          - _change_admin_password_from_previous.diff.before.comments == ""
          - _change_admin_password_from_previous.diff.before.enabled
          - not _change_admin_password_from_previous.diff.before.hidden
          - _change_admin_password_from_previous.diff.before.paths is defined
          - _change_admin_password_from_previous.diff.before.paths | length == 1
          - _change_admin_password_from_previous.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password From Previous previous output is not as expected.
        success_msg: The Change Admin Password From Previous previous output is as expected.

    - name: Verify Change Admin Password From Previous output
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous.task_sequence is defined
          - _change_admin_password_from_previous.task_sequence.id == "ADMIN-PASS2"
          - _change_admin_password_from_previous.task_sequence.name == "Change Admin Password From Previous"
          - _change_admin_password_from_previous.task_sequence.template == "Client.xml"
          - _change_admin_password_from_previous.task_sequence.product_key_type == "none"
          - _change_admin_password_from_previous.task_sequence.product_key is not defined
          - _change_admin_password_from_previous.task_sequence.admin_password is not defined
          - _change_admin_password_from_previous.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_from_previous.task_sequence.full_name == "Test User"
          - _change_admin_password_from_previous.task_sequence.organization == "Test Organization"
          - _change_admin_password_from_previous.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password_from_previous.task_sequence.version == "1.0"
          - _change_admin_password_from_previous.task_sequence.comments == ""
          - _change_admin_password_from_previous.task_sequence.enabled
          - not _change_admin_password_from_previous.task_sequence.hidden
          - _change_admin_password_from_previous.task_sequence.paths is defined
          - _change_admin_password_from_previous.task_sequence.paths | length == 1
          - _change_admin_password_from_previous.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password From Previous output is not as expected.
        success_msg: The Change Admin Password From Previous output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous_check.changed == _change_admin_password_from_previous.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Change Admin Password From Previous secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS2
        include_secrets: true
      register: _change_admin_password_from_previous_secrets

    - name: Verify Change Admin Password From Previous secrets
      ansible.builtin.assert:
        that:
          - _change_admin_password_from_previous_secrets.task_sequence is defined
          - _change_admin_password_from_previous_secrets.task_sequence.product_key_type == "none"
          - _change_admin_password_from_previous_secrets.task_sequence.product_key is not defined
          - _change_admin_password_from_previous_secrets.task_sequence.admin_password == "SecurePassword123!"
        fail_msg: The Change Admin Password From Previous secrets are not as expected.
        success_msg: The Change Admin Password From Previous secrets are as expected.

    - name: Change admin password to empty (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS3
        name: Change Admin Password To Empty
        template: Client.xml
        admin_password: ''
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password_to_empty_check

    - name: Verify Change Admin Password To Empty previous output # noqa no-handler
      when:
        - _change_admin_password_to_empty_check is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty_check.diff.before != None
          - _change_admin_password_to_empty_check.diff.before.id == "ADMIN-PASS3"
          - _change_admin_password_to_empty_check.diff.before.name == "Change Admin Password To Empty"
          - _change_admin_password_to_empty_check.diff.before.template == "Client.xml"
          - _change_admin_password_to_empty_check.diff.before.product_key_type == "none"
          - _change_admin_password_to_empty_check.diff.before.product_key is not defined
          - _change_admin_password_to_empty_check.diff.before.admin_password is not defined
          - _change_admin_password_to_empty_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_to_empty_check.diff.before.full_name == "Test User"
          - _change_admin_password_to_empty_check.diff.before.organization == "Test Organization"
          - _change_admin_password_to_empty_check.diff.before.ie_home_page == "about:blank"
          - _change_admin_password_to_empty_check.diff.before.version == "1.0"
          - _change_admin_password_to_empty_check.diff.before.comments == ""
          - _change_admin_password_to_empty_check.diff.before.enabled
          - not _change_admin_password_to_empty_check.diff.before.hidden
          - _change_admin_password_to_empty_check.diff.before.paths is defined
          - _change_admin_password_to_empty_check.diff.before.paths | length == 1
          - _change_admin_password_to_empty_check.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password To Empty previous output is not as expected.
        success_msg: The Change Admin Password To Empty previous output is as expected.

    - name: Verify Change Admin Password To Empty output
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty_check.task_sequence is defined
          - _change_admin_password_to_empty_check.task_sequence.id == "ADMIN-PASS3"
          - _change_admin_password_to_empty_check.task_sequence.name == "Change Admin Password To Empty"
          - _change_admin_password_to_empty_check.task_sequence.template == "Client.xml"
          - _change_admin_password_to_empty_check.task_sequence.product_key_type == "none"
          - _change_admin_password_to_empty_check.task_sequence.product_key is not defined
          - _change_admin_password_to_empty_check.task_sequence.admin_password is not defined
          - _change_admin_password_to_empty_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_to_empty_check.task_sequence.full_name == "Test User"
          - _change_admin_password_to_empty_check.task_sequence.organization == "Test Organization"
          - _change_admin_password_to_empty_check.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password_to_empty_check.task_sequence.version == "1.0"
          - _change_admin_password_to_empty_check.task_sequence.comments == ""
          - _change_admin_password_to_empty_check.task_sequence.enabled
          - not _change_admin_password_to_empty_check.task_sequence.hidden
          - _change_admin_password_to_empty_check.task_sequence.paths is defined
          - _change_admin_password_to_empty_check.task_sequence.paths | length == 1
          - _change_admin_password_to_empty_check.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password To Empty output is not as expected.
        success_msg: The Change Admin Password To Empty output is as expected.

    - name: Change admin password to empty
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS3
        name: Change Admin Password To Empty
        template: Client.xml
        admin_password: ''
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_admin_password_to_empty

    - name: Verify Change Admin Password To Empty previous output # noqa no-handler
      when:
        - _change_admin_password_to_empty is changed
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty.diff.before != None
          - _change_admin_password_to_empty.diff.before.id == "ADMIN-PASS3"
          - _change_admin_password_to_empty.diff.before.name == "Change Admin Password To Empty"
          - _change_admin_password_to_empty.diff.before.template == "Client.xml"
          - _change_admin_password_to_empty.diff.before.product_key_type == "none"
          - _change_admin_password_to_empty.diff.before.product_key is not defined
          - _change_admin_password_to_empty.diff.before.admin_password is not defined
          - _change_admin_password_to_empty.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_to_empty.diff.before.full_name == "Test User"
          - _change_admin_password_to_empty.diff.before.organization == "Test Organization"
          - _change_admin_password_to_empty.diff.before.ie_home_page == "about:blank"
          - _change_admin_password_to_empty.diff.before.version == "1.0"
          - _change_admin_password_to_empty.diff.before.comments == ""
          - _change_admin_password_to_empty.diff.before.enabled
          - not _change_admin_password_to_empty.diff.before.hidden
          - _change_admin_password_to_empty.diff.before.paths is defined
          - _change_admin_password_to_empty.diff.before.paths | length == 1
          - _change_admin_password_to_empty.diff.before.paths[0] == ""
        fail_msg: The Change Admin Password To Empty previous output is not as expected.
        success_msg: The Change Admin Password To Empty previous output is as expected.

    - name: Verify Change Admin Password To Empty output
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty.task_sequence is defined
          - _change_admin_password_to_empty.task_sequence.id == "ADMIN-PASS3"
          - _change_admin_password_to_empty.task_sequence.name == "Change Admin Password To Empty"
          - _change_admin_password_to_empty.task_sequence.template == "Client.xml"
          - _change_admin_password_to_empty.task_sequence.product_key_type == "none"
          - _change_admin_password_to_empty.task_sequence.product_key is not defined
          - _change_admin_password_to_empty.task_sequence.admin_password is not defined
          - _change_admin_password_to_empty.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_admin_password_to_empty.task_sequence.full_name == "Test User"
          - _change_admin_password_to_empty.task_sequence.organization == "Test Organization"
          - _change_admin_password_to_empty.task_sequence.ie_home_page == "about:blank"
          - _change_admin_password_to_empty.task_sequence.version == "1.0"
          - _change_admin_password_to_empty.task_sequence.comments == ""
          - _change_admin_password_to_empty.task_sequence.enabled
          - not _change_admin_password_to_empty.task_sequence.hidden
          - _change_admin_password_to_empty.task_sequence.paths is defined
          - _change_admin_password_to_empty.task_sequence.paths | length == 1
          - _change_admin_password_to_empty.task_sequence.paths[0] == ""
        fail_msg: The Change Admin Password To Empty output is not as expected.
        success_msg: The Change Admin Password To Empty output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty_check.changed == _change_admin_password_to_empty.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Check Change Admin Password To Empty secrets
      trippsc2.mdt.task_sequence_info:
        mdt_share_path: C:\MDTShare
        id: ADMIN-PASS3
        include_secrets: true
      register: _change_admin_password_to_empty_secrets

    - name: Verify Change Admin Password To Empty secrets
      ansible.builtin.assert:
        that:
          - _change_admin_password_to_empty_secrets.task_sequence is defined
          - _change_admin_password_to_empty_secrets.task_sequence.product_key_type == "none"
          - _change_admin_password_to_empty_secrets.task_sequence.product_key is not defined
          - _change_admin_password_to_empty_secrets.task_sequence.admin_password is not defined
        fail_msg: The Change Admin Password To Empty secrets are not as expected.
        success_msg: The Change Admin Password To Empty secrets are as expected.

    - name: Change full name (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: FULL-NAME
        name: Change Full Name
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User 2
        organization: Test Organization
        state: present
      register: _change_full_name_check

    - name: Verify Change Full Name previous output # noqa no-handler
      when:
        - _change_full_name_check is changed
      ansible.builtin.assert:
        that:
          - _change_full_name_check.diff.before != None
          - _change_full_name_check.diff.before.id == "FULL-NAME"
          - _change_full_name_check.diff.before.name == "Change Full Name"
          - _change_full_name_check.diff.before.template == "Client.xml"
          - _change_full_name_check.diff.before.product_key_type == "none"
          - _change_full_name_check.diff.before.product_key is not defined
          - _change_full_name_check.diff.before.admin_password is not defined
          - _change_full_name_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_full_name_check.diff.before.full_name == "Test User"
          - _change_full_name_check.diff.before.organization == "Test Organization"
          - _change_full_name_check.diff.before.ie_home_page == "about:blank"
          - _change_full_name_check.diff.before.version == "1.0"
          - _change_full_name_check.diff.before.comments == ""
          - _change_full_name_check.diff.before.enabled
          - not _change_full_name_check.diff.before.hidden
          - _change_full_name_check.diff.before.paths is defined
          - _change_full_name_check.diff.before.paths | length == 1
          - _change_full_name_check.diff.before.paths[0] == ""
        fail_msg: The Change Full Name previous output is not as expected.
        success_msg: The Change Full Name previous output is as expected.

    - name: Verify Change Full Name output
      ansible.builtin.assert:
        that:
          - _change_full_name_check.task_sequence is defined
          - _change_full_name_check.task_sequence.id == "FULL-NAME"
          - _change_full_name_check.task_sequence.name == "Change Full Name"
          - _change_full_name_check.task_sequence.template == "Client.xml"
          - _change_full_name_check.task_sequence.product_key_type == "none"
          - _change_full_name_check.task_sequence.product_key is not defined
          - _change_full_name_check.task_sequence.admin_password is not defined
          - _change_full_name_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_full_name_check.task_sequence.full_name == "Test User 2"
          - _change_full_name_check.task_sequence.organization == "Test Organization"
          - _change_full_name_check.task_sequence.ie_home_page == "about:blank"
          - _change_full_name_check.task_sequence.version == "1.0"
          - _change_full_name_check.task_sequence.comments == ""
          - _change_full_name_check.task_sequence.enabled
          - not _change_full_name_check.task_sequence.hidden
          - _change_full_name_check.task_sequence.paths is defined
          - _change_full_name_check.task_sequence.paths | length == 1
          - _change_full_name_check.task_sequence.paths[0] == ""
        fail_msg: The Change Full Name output is not as expected.
        success_msg: The Change Full Name output is as expected.

    - name: Change full name
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: FULL-NAME
        name: Change Full Name
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User 2
        organization: Test Organization
        state: present
      register: _change_full_name

    - name: Verify Change Full Name previous output # noqa no-handler
      when:
        - _change_full_name is changed
      ansible.builtin.assert:
        that:
          - _change_full_name.diff.before != None
          - _change_full_name.diff.before.id == "FULL-NAME"
          - _change_full_name.diff.before.name == "Change Full Name"
          - _change_full_name.diff.before.template == "Client.xml"
          - _change_full_name.diff.before.product_key_type == "none"
          - _change_full_name.diff.before.product_key is not defined
          - _change_full_name.diff.before.admin_password is not defined
          - _change_full_name.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_full_name.diff.before.full_name == "Test User"
          - _change_full_name.diff.before.organization == "Test Organization"
          - _change_full_name.diff.before.ie_home_page == "about:blank"
          - _change_full_name.diff.before.version == "1.0"
          - _change_full_name.diff.before.comments == ""
          - _change_full_name.diff.before.enabled
          - not _change_full_name.diff.before.hidden
          - _change_full_name.diff.before.paths is defined
          - _change_full_name.diff.before.paths | length == 1
          - _change_full_name.diff.before.paths[0] == ""
        fail_msg: The Change Full Name previous output is not as expected.
        success_msg: The Change Full Name previous output is as expected.

    - name: Verify Change Full Name output
      ansible.builtin.assert:
        that:
          - _change_full_name.task_sequence is defined
          - _change_full_name.task_sequence.id == "FULL-NAME"
          - _change_full_name.task_sequence.name == "Change Full Name"
          - _change_full_name.task_sequence.template == "Client.xml"
          - _change_full_name.task_sequence.product_key_type == "none"
          - _change_full_name.task_sequence.product_key is not defined
          - _change_full_name.task_sequence.admin_password is not defined
          - _change_full_name.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_full_name.task_sequence.full_name == "Test User 2"
          - _change_full_name.task_sequence.organization == "Test Organization"
          - _change_full_name.task_sequence.ie_home_page == "about:blank"
          - _change_full_name.task_sequence.version == "1.0"
          - _change_full_name.task_sequence.comments == ""
          - _change_full_name.task_sequence.enabled
          - not _change_full_name.task_sequence.hidden
          - _change_full_name.task_sequence.paths is defined
          - _change_full_name.task_sequence.paths | length == 1
          - _change_full_name.task_sequence.paths[0] == ""
        fail_msg: The Change Full Name output is not as expected.
        success_msg: The Change Full Name output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_full_name_check.changed == _change_full_name.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change organization (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ORG
        name: Change Organization
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization 2
        state: present
      register: _change_organization_check

    - name: Verify Change Organization previous output # noqa no-handler
      when:
        - _change_organization_check is changed
      ansible.builtin.assert:
        that:
          - _change_organization_check.diff.before != None
          - _change_organization_check.diff.before.id == "ORG"
          - _change_organization_check.diff.before.name == "Change Organization"
          - _change_organization_check.diff.before.template == "Client.xml"
          - _change_organization_check.diff.before.product_key_type == "none"
          - _change_organization_check.diff.before.product_key is not defined
          - _change_organization_check.diff.before.admin_password is not defined
          - _change_organization_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_organization_check.diff.before.full_name == "Test User"
          - _change_organization_check.diff.before.organization == "Test Organization"
          - _change_organization_check.diff.before.ie_home_page == "about:blank"
          - _change_organization_check.diff.before.version == "1.0"
          - _change_organization_check.diff.before.comments == ""
          - _change_organization_check.diff.before.enabled
          - not _change_organization_check.diff.before.hidden
          - _change_organization_check.diff.before.paths is defined
          - _change_organization_check.diff.before.paths | length == 1
          - _change_organization_check.diff.before.paths[0] == ""
        fail_msg: The Change Organization previous output is not as expected.
        success_msg: The Change Organization previous output is as expected.

    - name: Verify Change Organization output
      ansible.builtin.assert:
        that:
          - _change_organization_check.task_sequence is defined
          - _change_organization_check.task_sequence.id == "ORG"
          - _change_organization_check.task_sequence.name == "Change Organization"
          - _change_organization_check.task_sequence.template == "Client.xml"
          - _change_organization_check.task_sequence.product_key_type == "none"
          - _change_organization_check.task_sequence.product_key is not defined
          - _change_organization_check.task_sequence.admin_password is not defined
          - _change_organization_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_organization_check.task_sequence.full_name == "Test User"
          - _change_organization_check.task_sequence.organization == "Test Organization 2"
          - _change_organization_check.task_sequence.ie_home_page == "about:blank"
          - _change_organization_check.task_sequence.version == "1.0"
          - _change_organization_check.task_sequence.comments == ""
          - _change_organization_check.task_sequence.enabled
          - not _change_organization_check.task_sequence.hidden
          - _change_organization_check.task_sequence.paths is defined
          - _change_organization_check.task_sequence.paths | length == 1
          - _change_organization_check.task_sequence.paths[0] == ""
        fail_msg: The Change Organization output is not as expected.
        success_msg: The Change Organization output is as expected.

    - name: Change organization
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ORG
        name: Change Organization
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization 2
        state: present
      register: _change_organization

    - name: Verify Change Organization previous output # noqa no-handler
      when:
        - _change_organization is changed
      ansible.builtin.assert:
        that:
          - _change_organization.diff.before != None
          - _change_organization.diff.before.id == "ORG"
          - _change_organization.diff.before.name == "Change Organization"
          - _change_organization.diff.before.template == "Client.xml"
          - _change_organization.diff.before.product_key_type == "none"
          - _change_organization.diff.before.product_key is not defined
          - _change_organization.diff.before.admin_password is not defined
          - _change_organization.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_organization.diff.before.full_name == "Test User"
          - _change_organization.diff.before.organization == "Test Organization"
          - _change_organization.diff.before.ie_home_page == "about:blank"
          - _change_organization.diff.before.version == "1.0"
          - _change_organization.diff.before.comments == ""
          - _change_organization.diff.before.enabled
          - not _change_organization.diff.before.hidden
          - _change_organization.diff.before.paths is defined
          - _change_organization.diff.before.paths | length == 1
          - _change_organization.diff.before.paths[0] == ""
        fail_msg: The Change Organization previous output is not as expected.
        success_msg: The Change Organization previous output is as expected.

    - name: Verify Change Organization output
      ansible.builtin.assert:
        that:
          - _change_organization.task_sequence is defined
          - _change_organization.task_sequence.id == "ORG"
          - _change_organization.task_sequence.name == "Change Organization"
          - _change_organization.task_sequence.template == "Client.xml"
          - _change_organization.task_sequence.product_key_type == "none"
          - _change_organization.task_sequence.product_key is not defined
          - _change_organization.task_sequence.admin_password is not defined
          - _change_organization.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_organization.task_sequence.full_name == "Test User"
          - _change_organization.task_sequence.organization == "Test Organization 2"
          - _change_organization.task_sequence.ie_home_page == "about:blank"
          - _change_organization.task_sequence.version == "1.0"
          - _change_organization.task_sequence.comments == ""
          - _change_organization.task_sequence.enabled
          - not _change_organization.task_sequence.hidden
          - _change_organization.task_sequence.paths is defined
          - _change_organization.task_sequence.paths | length == 1
          - _change_organization.task_sequence.paths[0] == ""
        fail_msg: The Change Organization output is not as expected.
        success_msg: The Change Organization output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_organization_check.changed == _change_organization.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change IE home page (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: HOME-PAGE
        name: Change Home Page
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        ie_home_page: https://www.google.com
        state: present
      register: _change_home_page_check

    - name: Verify Change Home Page previous output # noqa no-handler
      when:
        - _change_home_page_check is changed
      ansible.builtin.assert:
        that:
          - _change_home_page_check.diff.before != None
          - _change_home_page_check.diff.before.id == "HOME-PAGE"
          - _change_home_page_check.diff.before.name == "Change Home Page"
          - _change_home_page_check.diff.before.template == "Client.xml"
          - _change_home_page_check.diff.before.product_key_type == "none"
          - _change_home_page_check.diff.before.product_key is not defined
          - _change_home_page_check.diff.before.admin_password is not defined
          - _change_home_page_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_home_page_check.diff.before.full_name == "Test User"
          - _change_home_page_check.diff.before.organization == "Test Organization"
          - _change_home_page_check.diff.before.ie_home_page == "about:blank"
          - _change_home_page_check.diff.before.version == "1.0"
          - _change_home_page_check.diff.before.comments == ""
          - _change_home_page_check.diff.before.enabled
          - not _change_home_page_check.diff.before.hidden
          - _change_home_page_check.diff.before.paths is defined
          - _change_home_page_check.diff.before.paths | length == 1
          - _change_home_page_check.diff.before.paths[0] == ""
        fail_msg: The Change Home Page previous output is not as expected.
        success_msg: The Change Home Page previous output is as expected.

    - name: Verify Change Home Page output
      ansible.builtin.assert:
        that:
          - _change_home_page_check.task_sequence is defined
          - _change_home_page_check.task_sequence.id == "HOME-PAGE"
          - _change_home_page_check.task_sequence.name == "Change Home Page"
          - _change_home_page_check.task_sequence.template == "Client.xml"
          - _change_home_page_check.task_sequence.product_key_type == "none"
          - _change_home_page_check.task_sequence.product_key is not defined
          - _change_home_page_check.task_sequence.admin_password is not defined
          - _change_home_page_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_home_page_check.task_sequence.full_name == "Test User"
          - _change_home_page_check.task_sequence.organization == "Test Organization"
          - _change_home_page_check.task_sequence.ie_home_page == "https://www.google.com"
          - _change_home_page_check.task_sequence.version == "1.0"
          - _change_home_page_check.task_sequence.comments == ""
          - _change_home_page_check.task_sequence.enabled
          - not _change_home_page_check.task_sequence.hidden
          - _change_home_page_check.task_sequence.paths is defined
          - _change_home_page_check.task_sequence.paths | length == 1
          - _change_home_page_check.task_sequence.paths[0] == ""
        fail_msg: The Change Home Page output is not as expected.
        success_msg: The Change Home Page output is as expected.

    - name: Change IE home page
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: HOME-PAGE
        name: Change Home Page
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        ie_home_page: https://www.google.com
        state: present
      register: _change_home_page

    - name: Verify Change Home Page previous output # noqa no-handler
      when:
        - _change_home_page is changed
      ansible.builtin.assert:
        that:
          - _change_home_page.diff.before != None
          - _change_home_page.diff.before.id == "HOME-PAGE"
          - _change_home_page.diff.before.name == "Change Home Page"
          - _change_home_page.diff.before.template == "Client.xml"
          - _change_home_page.diff.before.product_key_type == "none"
          - _change_home_page.diff.before.product_key is not defined
          - _change_home_page.diff.before.admin_password is not defined
          - _change_home_page.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_home_page.diff.before.full_name == "Test User"
          - _change_home_page.diff.before.organization == "Test Organization"
          - _change_home_page.diff.before.ie_home_page == "about:blank"
          - _change_home_page.diff.before.version == "1.0"
          - _change_home_page.diff.before.comments == ""
          - _change_home_page.diff.before.enabled
          - not _change_home_page.diff.before.hidden
          - _change_home_page.diff.before.paths is defined
          - _change_home_page.diff.before.paths | length == 1
          - _change_home_page.diff.before.paths[0] == ""
        fail_msg: The Change Home Page previous output is not as expected.
        success_msg: The Change Home Page previous output is as expected.

    - name: Verify Change Home Page output
      ansible.builtin.assert:
        that:
          - _change_home_page.task_sequence is defined
          - _change_home_page.task_sequence.id == "HOME-PAGE"
          - _change_home_page.task_sequence.name == "Change Home Page"
          - _change_home_page.task_sequence.template == "Client.xml"
          - _change_home_page.task_sequence.product_key_type == "none"
          - _change_home_page.task_sequence.product_key is not defined
          - _change_home_page.task_sequence.admin_password is not defined
          - _change_home_page.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_home_page.task_sequence.full_name == "Test User"
          - _change_home_page.task_sequence.organization == "Test Organization"
          - _change_home_page.task_sequence.ie_home_page == "https://www.google.com"
          - _change_home_page.task_sequence.version == "1.0"
          - _change_home_page.task_sequence.comments == ""
          - _change_home_page.task_sequence.enabled
          - not _change_home_page.task_sequence.hidden
          - _change_home_page.task_sequence.paths is defined
          - _change_home_page.task_sequence.paths | length == 1
          - _change_home_page.task_sequence.paths[0] == ""
        fail_msg: The Change Home Page output is not as expected.
        success_msg: The Change Home Page output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_home_page_check.changed == _change_home_page.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change version (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: VERSION
        name: Change Version
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        version: '2.0'
        state: present
      register: _change_version_check

    - name: Verify Change Version previous output # noqa no-handler
      when:
        - _change_version_check is changed
      ansible.builtin.assert:
        that:
          - _change_version_check.diff.before != None
          - _change_version_check.diff.before.id == "VERSION"
          - _change_version_check.diff.before.name == "Change Version"
          - _change_version_check.diff.before.template == "Client.xml"
          - _change_version_check.diff.before.product_key_type == "none"
          - _change_version_check.diff.before.product_key is not defined
          - _change_version_check.diff.before.admin_password is not defined
          - _change_version_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_version_check.diff.before.full_name == "Test User"
          - _change_version_check.diff.before.organization == "Test Organization"
          - _change_version_check.diff.before.ie_home_page == "about:blank"
          - _change_version_check.diff.before.version == "1.0"
          - _change_version_check.diff.before.comments == ""
          - _change_version_check.diff.before.enabled
          - not _change_version_check.diff.before.hidden
          - _change_version_check.diff.before.paths is defined
          - _change_version_check.diff.before.paths | length == 1
          - _change_version_check.diff.before.paths[0] == ""
        fail_msg: The Change Version previous output is not as expected.
        success_msg: The Change Version previous output is as expected.

    - name: Verify Change Version output
      ansible.builtin.assert:
        that:
          - _change_version_check.task_sequence is defined
          - _change_version_check.task_sequence.id == "VERSION"
          - _change_version_check.task_sequence.name == "Change Version"
          - _change_version_check.task_sequence.template == "Client.xml"
          - _change_version_check.task_sequence.product_key_type == "none"
          - _change_version_check.task_sequence.product_key is not defined
          - _change_version_check.task_sequence.admin_password is not defined
          - _change_version_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_version_check.task_sequence.full_name == "Test User"
          - _change_version_check.task_sequence.organization == "Test Organization"
          - _change_version_check.task_sequence.ie_home_page == "about:blank"
          - _change_version_check.task_sequence.version == "2.0"
          - _change_version_check.task_sequence.comments == ""
          - _change_version_check.task_sequence.enabled
          - not _change_version_check.task_sequence.hidden
          - _change_version_check.task_sequence.paths is defined
          - _change_version_check.task_sequence.paths | length == 1
          - _change_version_check.task_sequence.paths[0] == ""
        fail_msg: The Change Version output is not as expected.
        success_msg: The Change Version output is as expected.

    - name: Change version
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: VERSION
        name: Change Version
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        version: '2.0'
        state: present
      register: _change_version

    - name: Verify Change Version previous output # noqa no-handler
      when:
        - _change_version is changed
      ansible.builtin.assert:
        that:
          - _change_version.diff.before != None
          - _change_version.diff.before.id == "VERSION"
          - _change_version.diff.before.name == "Change Version"
          - _change_version.diff.before.template == "Client.xml"
          - _change_version.diff.before.product_key_type == "none"
          - _change_version.diff.before.product_key is not defined
          - _change_version.diff.before.admin_password is not defined
          - _change_version.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_version.diff.before.full_name == "Test User"
          - _change_version.diff.before.organization == "Test Organization"
          - _change_version.diff.before.ie_home_page == "about:blank"
          - _change_version.diff.before.version == "1.0"
          - _change_version.diff.before.comments == ""
          - _change_version.diff.before.enabled
          - not _change_version.diff.before.hidden
          - _change_version.diff.before.paths is defined
          - _change_version.diff.before.paths | length == 1
          - _change_version.diff.before.paths[0] == ""
        fail_msg: The Change Version previous output is not as expected.
        success_msg: The Change Version previous output is as expected.

    - name: Verify Change Version output
      ansible.builtin.assert:
        that:
          - _change_version.task_sequence is defined
          - _change_version.task_sequence.id == "VERSION"
          - _change_version.task_sequence.name == "Change Version"
          - _change_version.task_sequence.template == "Client.xml"
          - _change_version.task_sequence.product_key_type == "none"
          - _change_version.task_sequence.product_key is not defined
          - _change_version.task_sequence.admin_password is not defined
          - _change_version.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_version.task_sequence.full_name == "Test User"
          - _change_version.task_sequence.organization == "Test Organization"
          - _change_version.task_sequence.ie_home_page == "about:blank"
          - _change_version.task_sequence.version == "2.0"
          - _change_version.task_sequence.comments == ""
          - _change_version.task_sequence.enabled
          - not _change_version.task_sequence.hidden
          - _change_version.task_sequence.paths is defined
          - _change_version.task_sequence.paths | length == 1
          - _change_version.task_sequence.paths[0] == ""
        fail_msg: The Change Version output is not as expected.
        success_msg: The Change Version output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_version_check.changed == _change_version.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change comments (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: COMMENTS1
        name: Change Comments
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        comments: Test Comments
        state: present
      register: _change_comments_check

    - name: Verify Change Comments previous output # noqa no-handler
      when:
        - _change_comments_check is changed
      ansible.builtin.assert:
        that:
          - _change_comments_check.diff.before != None
          - _change_comments_check.diff.before.id == "COMMENTS1"
          - _change_comments_check.diff.before.name == "Change Comments"
          - _change_comments_check.diff.before.template == "Client.xml"
          - _change_comments_check.diff.before.product_key_type == "none"
          - _change_comments_check.diff.before.product_key is not defined
          - _change_comments_check.diff.before.admin_password is not defined
          - _change_comments_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_check.diff.before.full_name == "Test User"
          - _change_comments_check.diff.before.organization == "Test Organization"
          - _change_comments_check.diff.before.ie_home_page == "about:blank"
          - _change_comments_check.diff.before.version == "1.0"
          - _change_comments_check.diff.before.comments == ""
          - _change_comments_check.diff.before.enabled
          - not _change_comments_check.diff.before.hidden
          - _change_comments_check.diff.before.paths is defined
          - _change_comments_check.diff.before.paths | length == 1
          - _change_comments_check.diff.before.paths[0] == ""
        fail_msg: The Change Comments previous output is not as expected.
        success_msg: The Change Comments previous output is as expected.

    - name: Verify Change Comments output
      ansible.builtin.assert:
        that:
          - _change_comments_check.task_sequence is defined
          - _change_comments_check.task_sequence.id == "COMMENTS1"
          - _change_comments_check.task_sequence.name == "Change Comments"
          - _change_comments_check.task_sequence.template == "Client.xml"
          - _change_comments_check.task_sequence.product_key_type == "none"
          - _change_comments_check.task_sequence.product_key is not defined
          - _change_comments_check.task_sequence.admin_password is not defined
          - _change_comments_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_check.task_sequence.full_name == "Test User"
          - _change_comments_check.task_sequence.organization == "Test Organization"
          - _change_comments_check.task_sequence.ie_home_page == "about:blank"
          - _change_comments_check.task_sequence.version == "1.0"
          - _change_comments_check.task_sequence.comments == "Test Comments"
          - _change_comments_check.task_sequence.enabled
          - not _change_comments_check.task_sequence.hidden
          - _change_comments_check.task_sequence.paths is defined
          - _change_comments_check.task_sequence.paths | length == 1
          - _change_comments_check.task_sequence.paths[0] == ""
        fail_msg: The Change Comments output is not as expected.
        success_msg: The Change Comments output is as expected.

    - name: Change comments
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: COMMENTS1
        name: Change Comments
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        comments: Test Comments
        state: present
      register: _change_comments

    - name: Verify Change Comments previous output # noqa no-handler
      when:
        - _change_comments is changed
      ansible.builtin.assert:
        that:
          - _change_comments.diff.before != None
          - _change_comments.diff.before.id == "COMMENTS1"
          - _change_comments.diff.before.name == "Change Comments"
          - _change_comments.diff.before.template == "Client.xml"
          - _change_comments.diff.before.product_key_type == "none"
          - _change_comments.diff.before.product_key is not defined
          - _change_comments.diff.before.admin_password is not defined
          - _change_comments.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_comments.diff.before.full_name == "Test User"
          - _change_comments.diff.before.organization == "Test Organization"
          - _change_comments.diff.before.ie_home_page == "about:blank"
          - _change_comments.diff.before.version == "1.0"
          - _change_comments.diff.before.comments == ""
          - _change_comments.diff.before.enabled
          - not _change_comments.diff.before.hidden
          - _change_comments.diff.before.paths is defined
          - _change_comments.diff.before.paths | length == 1
          - _change_comments.diff.before.paths[0] == ""
        fail_msg: The Change Comments previous output is not as expected.
        success_msg: The Change Comments previous output is as expected.

    - name: Verify Change Comments output
      ansible.builtin.assert:
        that:
          - _change_comments.task_sequence is defined
          - _change_comments.task_sequence.id == "COMMENTS1"
          - _change_comments.task_sequence.name == "Change Comments"
          - _change_comments.task_sequence.template == "Client.xml"
          - _change_comments.task_sequence.product_key_type == "none"
          - _change_comments.task_sequence.product_key is not defined
          - _change_comments.task_sequence.admin_password is not defined
          - _change_comments.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_comments.task_sequence.full_name == "Test User"
          - _change_comments.task_sequence.organization == "Test Organization"
          - _change_comments.task_sequence.ie_home_page == "about:blank"
          - _change_comments.task_sequence.version == "1.0"
          - _change_comments.task_sequence.comments == "Test Comments"
          - _change_comments.task_sequence.enabled
          - not _change_comments.task_sequence.hidden
          - _change_comments.task_sequence.paths is defined
          - _change_comments.task_sequence.paths | length == 1
          - _change_comments.task_sequence.paths[0] == ""
        fail_msg: The Change Comments output is not as expected.
        success_msg: The Change Comments output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_comments_check.changed == _change_comments.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change Comments from previous (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: COMMENTS2
        name: Change Comments From Previous
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        comments: New Comments
        state: present
      register: _change_comments_from_previous_check

    - name: Verify Change Comments From Previous previous output # noqa no-handler
      when:
        - _change_comments_from_previous_check is changed
      ansible.builtin.assert:
        that:
          - _change_comments_from_previous_check.diff.before != None
          - _change_comments_from_previous_check.diff.before.id == "COMMENTS2"
          - _change_comments_from_previous_check.diff.before.name == "Change Comments From Previous"
          - _change_comments_from_previous_check.diff.before.template == "Client.xml"
          - _change_comments_from_previous_check.diff.before.product_key_type == "none"
          - _change_comments_from_previous_check.diff.before.product_key is not defined
          - _change_comments_from_previous_check.diff.before.admin_password is not defined
          - _change_comments_from_previous_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_from_previous_check.diff.before.full_name == "Test User"
          - _change_comments_from_previous_check.diff.before.organization == "Test Organization"
          - _change_comments_from_previous_check.diff.before.ie_home_page == "about:blank"
          - _change_comments_from_previous_check.diff.before.version == "1.0"
          - _change_comments_from_previous_check.diff.before.comments == "Old Comments"
          - _change_comments_from_previous_check.diff.before.enabled
          - not _change_comments_from_previous_check.diff.before.hidden
          - _change_comments_from_previous_check.diff.before.paths is defined
          - _change_comments_from_previous_check.diff.before.paths | length == 1
          - _change_comments_from_previous_check.diff.before.paths[0] == ""
        fail_msg: The Change Comments From Previous previous output is not as expected.
        success_msg: The Change Comments From Previous previous output is as expected.

    - name: Verify Change Comments From Previous output
      ansible.builtin.assert:
        that:
          - _change_comments_from_previous_check.task_sequence is defined
          - _change_comments_from_previous_check.task_sequence.id == "COMMENTS2"
          - _change_comments_from_previous_check.task_sequence.name == "Change Comments From Previous"
          - _change_comments_from_previous_check.task_sequence.template == "Client.xml"
          - _change_comments_from_previous_check.task_sequence.product_key_type == "none"
          - _change_comments_from_previous_check.task_sequence.product_key is not defined
          - _change_comments_from_previous_check.task_sequence.admin_password is not defined
          - _change_comments_from_previous_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_from_previous_check.task_sequence.full_name == "Test User"
          - _change_comments_from_previous_check.task_sequence.organization == "Test Organization"
          - _change_comments_from_previous_check.task_sequence.ie_home_page == "about:blank"
          - _change_comments_from_previous_check.task_sequence.version == "1.0"
          - _change_comments_from_previous_check.task_sequence.comments == "New Comments"
          - _change_comments_from_previous_check.task_sequence.enabled
          - not _change_comments_from_previous_check.task_sequence.hidden
          - _change_comments_from_previous_check.task_sequence.paths is defined
          - _change_comments_from_previous_check.task_sequence.paths | length == 1
          - _change_comments_from_previous_check.task_sequence.paths[0] == ""
        fail_msg: The Change Comments From Previous output is not as expected.
        success_msg: The Change Comments From Previous output is as expected.

    - name: Change Comments from previous
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: COMMENTS2
        name: Change Comments From Previous
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        comments: New Comments
        state: present
      register: _change_comments_from_previous

    - name: Verify Change Comments From Previous previous output # noqa no-handler
      when:
        - _change_comments_from_previous is changed
      ansible.builtin.assert:
        that:
          - _change_comments_from_previous.diff.before != None
          - _change_comments_from_previous.diff.before.id == "COMMENTS2"
          - _change_comments_from_previous.diff.before.name == "Change Comments From Previous"
          - _change_comments_from_previous.diff.before.template == "Client.xml"
          - _change_comments_from_previous.diff.before.product_key_type == "none"
          - _change_comments_from_previous.diff.before.product_key is not defined
          - _change_comments_from_previous.diff.before.admin_password is not defined
          - _change_comments_from_previous.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_from_previous.diff.before.full_name == "Test User"
          - _change_comments_from_previous.diff.before.organization == "Test Organization"
          - _change_comments_from_previous.diff.before.ie_home_page == "about:blank"
          - _change_comments_from_previous.diff.before.version == "1.0"
          - _change_comments_from_previous.diff.before.comments == "Old Comments"
          - _change_comments_from_previous.diff.before.enabled
          - not _change_comments_from_previous.diff.before.hidden
          - _change_comments_from_previous.diff.before.paths is defined
          - _change_comments_from_previous.diff.before.paths | length == 1
          - _change_comments_from_previous.diff.before.paths[0] == ""
        fail_msg: The Change Comments From Previous previous output is not as expected.
        success_msg: The Change Comments From Previous previous output is as expected.

    - name: Verify Change Comments From Previous output
      ansible.builtin.assert:
        that:
          - _change_comments_from_previous.task_sequence is defined
          - _change_comments_from_previous.task_sequence.id == "COMMENTS2"
          - _change_comments_from_previous.task_sequence.name == "Change Comments From Previous"
          - _change_comments_from_previous.task_sequence.template == "Client.xml"
          - _change_comments_from_previous.task_sequence.product_key_type == "none"
          - _change_comments_from_previous.task_sequence.product_key is not defined
          - _change_comments_from_previous.task_sequence.admin_password is not defined
          - _change_comments_from_previous.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_comments_from_previous.task_sequence.full_name == "Test User"
          - _change_comments_from_previous.task_sequence.organization == "Test Organization"
          - _change_comments_from_previous.task_sequence.ie_home_page == "about:blank"
          - _change_comments_from_previous.task_sequence.version == "1.0"
          - _change_comments_from_previous.task_sequence.comments == "New Comments"
          - _change_comments_from_previous.task_sequence.enabled
          - not _change_comments_from_previous.task_sequence.hidden
          - _change_comments_from_previous.task_sequence.paths is defined
          - _change_comments_from_previous.task_sequence.paths | length == 1
          - _change_comments_from_previous.task_sequence.paths[0] == ""
        fail_msg: The Change Comments From Previous output is not as expected.
        success_msg: The Change Comments From Previous output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_comments_from_previous_check.changed == _change_comments_from_previous.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change enabled (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ENABLED
        name: Change Enabled
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        enabled: true
        state: present
      register: _change_enabled_check

    - name: Verify Change Enabled previous output # noqa no-handler
      when:
        - _change_enabled_check is changed
      ansible.builtin.assert:
        that:
          - _change_enabled_check.diff.before != None
          - _change_enabled_check.diff.before.id == "ENABLED"
          - _change_enabled_check.diff.before.name == "Change Enabled"
          - _change_enabled_check.diff.before.template == "Client.xml"
          - _change_enabled_check.diff.before.product_key_type == "none"
          - _change_enabled_check.diff.before.product_key is not defined
          - _change_enabled_check.diff.before.admin_password is not defined
          - _change_enabled_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_enabled_check.diff.before.full_name == "Test User"
          - _change_enabled_check.diff.before.organization == "Test Organization"
          - _change_enabled_check.diff.before.ie_home_page == "about:blank"
          - _change_enabled_check.diff.before.version == "1.0"
          - _change_enabled_check.diff.before.comments == ""
          - not _change_enabled_check.diff.before.enabled
          - not _change_enabled_check.diff.before.hidden
          - _change_enabled_check.diff.before.paths is defined
          - _change_enabled_check.diff.before.paths | length == 1
          - _change_enabled_check.diff.before.paths[0] == ""
        fail_msg: The Change Enabled previous output is not as expected.
        success_msg: The Change Enabled previous output is as expected.

    - name: Verify Change Enabled output
      ansible.builtin.assert:
        that:
          - _change_enabled_check.task_sequence is defined
          - _change_enabled_check.task_sequence.id == "ENABLED"
          - _change_enabled_check.task_sequence.name == "Change Enabled"
          - _change_enabled_check.task_sequence.template == "Client.xml"
          - _change_enabled_check.task_sequence.product_key_type == "none"
          - _change_enabled_check.task_sequence.product_key is not defined
          - _change_enabled_check.task_sequence.admin_password is not defined
          - _change_enabled_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_enabled_check.task_sequence.full_name == "Test User"
          - _change_enabled_check.task_sequence.organization == "Test Organization"
          - _change_enabled_check.task_sequence.ie_home_page == "about:blank"
          - _change_enabled_check.task_sequence.version == "1.0"
          - _change_enabled_check.task_sequence.comments == ""
          - _change_enabled_check.task_sequence.enabled
          - not _change_enabled_check.task_sequence.hidden
          - _change_enabled_check.task_sequence.paths is defined
          - _change_enabled_check.task_sequence.paths | length == 1
          - _change_enabled_check.task_sequence.paths[0] == ""
        fail_msg: The Change Enabled output is not as expected.
        success_msg: The Change Enabled output is as expected.

    - name: Change enabled
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ENABLED
        name: Change Enabled
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        enabled: true
        state: present
      register: _change_enabled

    - name: Verify Change Enabled previous output # noqa no-handler
      when:
        - _change_enabled is changed
      ansible.builtin.assert:
        that:
          - _change_enabled.diff.before != None
          - _change_enabled.diff.before.id == "ENABLED"
          - _change_enabled.diff.before.name == "Change Enabled"
          - _change_enabled.diff.before.template == "Client.xml"
          - _change_enabled.diff.before.product_key_type == "none"
          - _change_enabled.diff.before.product_key is not defined
          - _change_enabled.diff.before.admin_password is not defined
          - _change_enabled.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_enabled.diff.before.full_name == "Test User"
          - _change_enabled.diff.before.organization == "Test Organization"
          - _change_enabled.diff.before.ie_home_page == "about:blank"
          - _change_enabled.diff.before.version == "1.0"
          - _change_enabled.diff.before.comments == ""
          - not _change_enabled.diff.before.enabled
          - not _change_enabled.diff.before.hidden
          - _change_enabled.diff.before.paths is defined
          - _change_enabled.diff.before.paths | length == 1
          - _change_enabled.diff.before.paths[0] == ""
        fail_msg: The Change Enabled previous output is not as expected.
        success_msg: The Change Enabled previous output is as expected.

    - name: Verify Change Enabled output
      ansible.builtin.assert:
        that:
          - _change_enabled.task_sequence is defined
          - _change_enabled.task_sequence.id == "ENABLED"
          - _change_enabled.task_sequence.name == "Change Enabled"
          - _change_enabled.task_sequence.template == "Client.xml"
          - _change_enabled.task_sequence.product_key_type == "none"
          - _change_enabled.task_sequence.product_key is not defined
          - _change_enabled.task_sequence.admin_password is not defined
          - _change_enabled.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_enabled.task_sequence.full_name == "Test User"
          - _change_enabled.task_sequence.organization == "Test Organization"
          - _change_enabled.task_sequence.ie_home_page == "about:blank"
          - _change_enabled.task_sequence.version == "1.0"
          - _change_enabled.task_sequence.comments == ""
          - _change_enabled.task_sequence.enabled
          - not _change_enabled.task_sequence.hidden
          - _change_enabled.task_sequence.paths is defined
          - _change_enabled.task_sequence.paths | length == 1
          - _change_enabled.task_sequence.paths[0] == ""
        fail_msg: The Change Enabled output is not as expected.
        success_msg: The Change Enabled output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_enabled_check.changed == _change_enabled.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change hidden (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: HIDDEN
        name: Change Hidden
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        hidden: false
        state: present
      register: _change_hidden_check

    - name: Verify Change Hidden previous output # noqa no-handler
      when:
        - _change_hidden_check is changed
      ansible.builtin.assert:
        that:
          - _change_hidden_check.diff.before != None
          - _change_hidden_check.diff.before.id == "HIDDEN"
          - _change_hidden_check.diff.before.name == "Change Hidden"
          - _change_hidden_check.diff.before.template == "Client.xml"
          - _change_hidden_check.diff.before.product_key_type == "none"
          - _change_hidden_check.diff.before.product_key is not defined
          - _change_hidden_check.diff.before.admin_password is not defined
          - _change_hidden_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_hidden_check.diff.before.full_name == "Test User"
          - _change_hidden_check.diff.before.organization == "Test Organization"
          - _change_hidden_check.diff.before.ie_home_page == "about:blank"
          - _change_hidden_check.diff.before.version == "1.0"
          - _change_hidden_check.diff.before.comments == ""
          - _change_hidden_check.diff.before.enabled
          - _change_hidden_check.diff.before.hidden
          - _change_hidden_check.diff.before.paths is defined
          - _change_hidden_check.diff.before.paths | length == 1
          - _change_hidden_check.diff.before.paths[0] == ""
        fail_msg: The Change Hidden previous output is not as expected.
        success_msg: The Change Hidden previous output is as expected.

    - name: Verify Change Hidden output
      ansible.builtin.assert:
        that:
          - _change_hidden_check.task_sequence is defined
          - _change_hidden_check.task_sequence.id == "HIDDEN"
          - _change_hidden_check.task_sequence.name == "Change Hidden"
          - _change_hidden_check.task_sequence.template == "Client.xml"
          - _change_hidden_check.task_sequence.product_key_type == "none"
          - _change_hidden_check.task_sequence.product_key is not defined
          - _change_hidden_check.task_sequence.admin_password is not defined
          - _change_hidden_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_hidden_check.task_sequence.full_name == "Test User"
          - _change_hidden_check.task_sequence.organization == "Test Organization"
          - _change_hidden_check.task_sequence.ie_home_page == "about:blank"
          - _change_hidden_check.task_sequence.version == "1.0"
          - _change_hidden_check.task_sequence.comments == ""
          - _change_hidden_check.task_sequence.enabled
          - not _change_hidden_check.task_sequence.hidden
          - _change_hidden_check.task_sequence.paths is defined
          - _change_hidden_check.task_sequence.paths | length == 1
          - _change_hidden_check.task_sequence.paths[0] == ""
        fail_msg: The Change Hidden output is not as expected.
        success_msg: The Change Hidden output is as expected.

    - name: Change hidden
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: HIDDEN
        name: Change Hidden
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        hidden: false
        state: present
      register: _change_hidden

    - name: Verify Change Hidden previous output # noqa no-handler
      when:
        - _change_hidden is changed
      ansible.builtin.assert:
        that:
          - _change_hidden.diff.before != None
          - _change_hidden.diff.before.id == "HIDDEN"
          - _change_hidden.diff.before.name == "Change Hidden"
          - _change_hidden.diff.before.template == "Client.xml"
          - _change_hidden.diff.before.product_key_type == "none"
          - _change_hidden.diff.before.product_key is not defined
          - _change_hidden.diff.before.admin_password is not defined
          - _change_hidden.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_hidden.diff.before.full_name == "Test User"
          - _change_hidden.diff.before.organization == "Test Organization"
          - _change_hidden.diff.before.ie_home_page == "about:blank"
          - _change_hidden.diff.before.version == "1.0"
          - _change_hidden.diff.before.comments == ""
          - _change_hidden.diff.before.enabled
          - _change_hidden.diff.before.hidden
          - _change_hidden.diff.before.paths is defined
          - _change_hidden.diff.before.paths | length == 1
          - _change_hidden.diff.before.paths[0] == ""
        fail_msg: The Change Hidden previous output is not as expected.
        success_msg: The Change Hidden previous output is as expected.

    - name: Verify Change Hidden output
      ansible.builtin.assert:
        that:
          - _change_hidden.task_sequence is defined
          - _change_hidden.task_sequence.id == "HIDDEN"
          - _change_hidden.task_sequence.name == "Change Hidden"
          - _change_hidden.task_sequence.template == "Client.xml"
          - _change_hidden.task_sequence.product_key_type == "none"
          - _change_hidden.task_sequence.product_key is not defined
          - _change_hidden.task_sequence.admin_password is not defined
          - _change_hidden.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_hidden.task_sequence.full_name == "Test User"
          - _change_hidden.task_sequence.organization == "Test Organization"
          - _change_hidden.task_sequence.ie_home_page == "about:blank"
          - _change_hidden.task_sequence.version == "1.0"
          - _change_hidden.task_sequence.comments == ""
          - _change_hidden.task_sequence.enabled
          - not _change_hidden.task_sequence.hidden
          - _change_hidden.task_sequence.paths is defined
          - _change_hidden.task_sequence.paths | length == 1
          - _change_hidden.task_sequence.paths[0] == ""
        fail_msg: The Change Hidden output is not as expected.
        success_msg: The Change Hidden output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_hidden_check.changed == _change_hidden.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Change name (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RENAME
        name: New Name
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_name_check

    - name: Verify Change Name previous output # noqa no-handler
      when:
        - _change_name_check is changed
      ansible.builtin.assert:
        that:
          - _change_name_check.diff.before != None
          - _change_name_check.diff.before.id == "RENAME"
          - _change_name_check.diff.before.name == "Rename"
          - _change_name_check.diff.before.template == "Client.xml"
          - _change_name_check.diff.before.product_key_type == "none"
          - _change_name_check.diff.before.product_key is not defined
          - _change_name_check.diff.before.admin_password is not defined
          - _change_name_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_name_check.diff.before.full_name == "Test User"
          - _change_name_check.diff.before.organization == "Test Organization"
          - _change_name_check.diff.before.ie_home_page == "about:blank"
          - _change_name_check.diff.before.version == "1.0"
          - _change_name_check.diff.before.comments == ""
          - _change_name_check.diff.before.enabled
          - not _change_name_check.diff.before.hidden
          - _change_name_check.diff.before.paths is defined
          - _change_name_check.diff.before.paths | length == 1
          - _change_name_check.diff.before.paths[0] == ""
        fail_msg: The Change Name previous output is not as expected.
        success_msg: The Change Name previous output is as expected.

    - name: Verify Change Name output
      ansible.builtin.assert:
        that:
          - _change_name_check.task_sequence is defined
          - _change_name_check.task_sequence.id == "RENAME"
          - _change_name_check.task_sequence.name == "New Name"
          - _change_name_check.task_sequence.template == "Client.xml"
          - _change_name_check.task_sequence.product_key_type == "none"
          - _change_name_check.task_sequence.product_key is not defined
          - _change_name_check.task_sequence.admin_password is not defined
          - _change_name_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_name_check.task_sequence.full_name == "Test User"
          - _change_name_check.task_sequence.organization == "Test Organization"
          - _change_name_check.task_sequence.ie_home_page == "about:blank"
          - _change_name_check.task_sequence.version == "1.0"
          - _change_name_check.task_sequence.comments == ""
          - _change_name_check.task_sequence.enabled
          - not _change_name_check.task_sequence.hidden
          - _change_name_check.task_sequence.paths is defined
          - _change_name_check.task_sequence.paths | length == 1
          - _change_name_check.task_sequence.paths[0] == ""
        fail_msg: The Change Name output is not as expected.
        success_msg: The Change Name output is as expected.

    - name: Change name
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: RENAME
        name: New Name
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        state: present
      register: _change_name

    - name: Verify Change Name previous output # noqa no-handler
      when:
        - _change_name is changed
      ansible.builtin.assert:
        that:
          - _change_name.diff.before != None
          - _change_name.diff.before.id == "RENAME"
          - _change_name.diff.before.name == "Rename"
          - _change_name.diff.before.template == "Client.xml"
          - _change_name.diff.before.product_key_type == "none"
          - _change_name.diff.before.product_key is not defined
          - _change_name.diff.before.admin_password is not defined
          - _change_name.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _change_name.diff.before.full_name == "Test User"
          - _change_name.diff.before.organization == "Test Organization"
          - _change_name.diff.before.ie_home_page == "about:blank"
          - _change_name.diff.before.version == "1.0"
          - _change_name.diff.before.comments == ""
          - _change_name.diff.before.enabled
          - not _change_name.diff.before.hidden
          - _change_name.diff.before.paths is defined
          - _change_name.diff.before.paths | length == 1
          - _change_name.diff.before.paths[0] == ""
        fail_msg: The Change Name previous output is not as expected.
        success_msg: The Change Name previous output is as expected.

    - name: Verify Change Name output
      ansible.builtin.assert:
        that:
          - _change_name.task_sequence is defined
          - _change_name.task_sequence.id == "RENAME"
          - _change_name.task_sequence.name == "New Name"
          - _change_name.task_sequence.template == "Client.xml"
          - _change_name.task_sequence.product_key_type == "none"
          - _change_name.task_sequence.product_key is not defined
          - _change_name.task_sequence.admin_password is not defined
          - _change_name.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _change_name.task_sequence.full_name == "Test User"
          - _change_name.task_sequence.organization == "Test Organization"
          - _change_name.task_sequence.ie_home_page == "about:blank"
          - _change_name.task_sequence.version == "1.0"
          - _change_name.task_sequence.comments == ""
          - _change_name.task_sequence.enabled
          - not _change_name.task_sequence.hidden
          - _change_name.task_sequence.paths is defined
          - _change_name.task_sequence.paths | length == 1
          - _change_name.task_sequence.paths[0] == ""
        fail_msg: The Change Name output is not as expected.
        success_msg: The Change Name output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _change_name_check.changed == _change_name.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Add task sequence paths (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADD-PATHS
        name: Add Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          add:
            - Subdirectory
        state: present
      register: _add_paths_check

    - name: Verify Add Paths previous output # noqa no-handler
      when:
        - _add_paths_check is changed
      ansible.builtin.assert:
        that:
          - _add_paths_check.diff.before != None
          - _add_paths_check.diff.before.id == "ADD-PATHS"
          - _add_paths_check.diff.before.name == "Add Paths"
          - _add_paths_check.diff.before.template == "Client.xml"
          - _add_paths_check.diff.before.product_key_type == "none"
          - _add_paths_check.diff.before.product_key is not defined
          - _add_paths_check.diff.before.admin_password is not defined
          - _add_paths_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _add_paths_check.diff.before.full_name == "Test User"
          - _add_paths_check.diff.before.organization == "Test Organization"
          - _add_paths_check.diff.before.ie_home_page == "about:blank"
          - _add_paths_check.diff.before.version == "1.0"
          - _add_paths_check.diff.before.comments == ""
          - _add_paths_check.diff.before.enabled
          - not _add_paths_check.diff.before.hidden
          - _add_paths_check.diff.before.paths is defined
          - _add_paths_check.diff.before.paths | length == 1
          - _add_paths_check.diff.before.paths[0] == ""
        fail_msg: The Add Paths previous output is not as expected.
        success_msg: The Add Paths previous output is as expected.

    - name: Verify Add Paths output
      ansible.builtin.assert:
        that:
          - _add_paths_check.task_sequence is defined
          - _add_paths_check.task_sequence.id == "ADD-PATHS"
          - _add_paths_check.task_sequence.name == "Add Paths"
          - _add_paths_check.task_sequence.template == "Client.xml"
          - _add_paths_check.task_sequence.product_key_type == "none"
          - _add_paths_check.task_sequence.product_key is not defined
          - _add_paths_check.task_sequence.admin_password is not defined
          - _add_paths_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _add_paths_check.task_sequence.full_name == "Test User"
          - _add_paths_check.task_sequence.organization == "Test Organization"
          - _add_paths_check.task_sequence.ie_home_page == "about:blank"
          - _add_paths_check.task_sequence.version == "1.0"
          - _add_paths_check.task_sequence.comments == ""
          - _add_paths_check.task_sequence.enabled
          - not _add_paths_check.task_sequence.hidden
          - _add_paths_check.task_sequence.paths is defined
          - _add_paths_check.task_sequence.paths | length == 2
          - '"Subdirectory" in _add_paths_check.task_sequence.paths'
          - '"" in _add_paths_check.task_sequence.paths'
        fail_msg: The Add Paths output is not as expected.
        success_msg: The Add Paths output is as expected.

    - name: Add task sequence paths
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADD-PATHS
        name: Add Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          add:
            - Subdirectory
        state: present
      register: _add_paths

    - name: Verify Add Paths previous output # noqa no-handler
      when:
        - _add_paths is changed
      ansible.builtin.assert:
        that:
          - _add_paths.diff.before != None
          - _add_paths.diff.before.id == "ADD-PATHS"
          - _add_paths.diff.before.name == "Add Paths"
          - _add_paths.diff.before.template == "Client.xml"
          - _add_paths.diff.before.product_key_type == "none"
          - _add_paths.diff.before.product_key is not defined
          - _add_paths.diff.before.admin_password is not defined
          - _add_paths.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _add_paths.diff.before.full_name == "Test User"
          - _add_paths.diff.before.organization == "Test Organization"
          - _add_paths.diff.before.ie_home_page == "about:blank"
          - _add_paths.diff.before.version == "1.0"
          - _add_paths.diff.before.comments == ""
          - _add_paths.diff.before.enabled
          - not _add_paths.diff.before.hidden
          - _add_paths.diff.before.paths is defined
          - _add_paths.diff.before.paths | length == 1
          - _add_paths.diff.before.paths[0] == ""
        fail_msg: The Add Paths previous output is not as expected.
        success_msg: The Add Paths previous output is as expected.

    - name: Verify Add Paths output
      ansible.builtin.assert:
        that:
          - _add_paths.task_sequence is defined
          - _add_paths.task_sequence.id == "ADD-PATHS"
          - _add_paths.task_sequence.name == "Add Paths"
          - _add_paths.task_sequence.template == "Client.xml"
          - _add_paths.task_sequence.product_key_type == "none"
          - _add_paths.task_sequence.product_key is not defined
          - _add_paths.task_sequence.admin_password is not defined
          - _add_paths.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _add_paths.task_sequence.full_name == "Test User"
          - _add_paths.task_sequence.organization == "Test Organization"
          - _add_paths.task_sequence.ie_home_page == "about:blank"
          - _add_paths.task_sequence.version == "1.0"
          - _add_paths.task_sequence.comments == ""
          - _add_paths.task_sequence.enabled
          - not _add_paths.task_sequence.hidden
          - _add_paths.task_sequence.paths is defined
          - _add_paths.task_sequence.paths | length == 2
          - '"Subdirectory" in _add_paths.task_sequence.paths'
          - '"" in _add_paths.task_sequence.paths'
        fail_msg: The Add Paths output is not as expected.
        success_msg: The Add Paths output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _add_paths_check.changed == _add_paths.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Remove task sequence paths (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: REMOVE-PATHS
        name: Remove Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          remove:
            - Subdirectory
        state: present
      register: _remove_paths_check

    - name: Verify Remove Paths previous output # noqa no-handler
      when:
        - _remove_paths_check is changed
      ansible.builtin.assert:
        that:
          - _remove_paths_check.diff.before != None
          - _remove_paths_check.diff.before.id == "REMOVE-PATHS"
          - _remove_paths_check.diff.before.name == "Remove Paths"
          - _remove_paths_check.diff.before.template == "Client.xml"
          - _remove_paths_check.diff.before.product_key_type == "none"
          - _remove_paths_check.diff.before.product_key is not defined
          - _remove_paths_check.diff.before.admin_password is not defined
          - _remove_paths_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_paths_check.diff.before.full_name == "Test User"
          - _remove_paths_check.diff.before.organization == "Test Organization"
          - _remove_paths_check.diff.before.ie_home_page == "about:blank"
          - _remove_paths_check.diff.before.version == "1.0"
          - _remove_paths_check.diff.before.comments == ""
          - _remove_paths_check.diff.before.enabled
          - not _remove_paths_check.diff.before.hidden
          - _remove_paths_check.diff.before.paths is defined
          - _remove_paths_check.diff.before.paths | length == 2
          - '"Subdirectory" in _remove_paths_check.diff.before.paths'
          - '"" in _remove_paths_check.diff.before.paths'
        fail_msg: The Remove Paths previous output is not as expected.
        success_msg: The Remove Paths previous output is as expected.

    - name: Verify Remove Paths output
      ansible.builtin.assert:
        that:
          - _remove_paths_check.task_sequence is defined
          - _remove_paths_check.task_sequence.id == "REMOVE-PATHS"
          - _remove_paths_check.task_sequence.name == "Remove Paths"
          - _remove_paths_check.task_sequence.template == "Client.xml"
          - _remove_paths_check.task_sequence.product_key_type == "none"
          - _remove_paths_check.task_sequence.product_key is not defined
          - _remove_paths_check.task_sequence.admin_password is not defined
          - _remove_paths_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _remove_paths_check.task_sequence.full_name == "Test User"
          - _remove_paths_check.task_sequence.organization == "Test Organization"
          - _remove_paths_check.task_sequence.ie_home_page == "about:blank"
          - _remove_paths_check.task_sequence.version == "1.0"
          - _remove_paths_check.task_sequence.comments == ""
          - _remove_paths_check.task_sequence.enabled
          - not _remove_paths_check.task_sequence.hidden
          - _remove_paths_check.task_sequence.paths is defined
          - _remove_paths_check.task_sequence.paths | length == 1
          - _remove_paths_check.task_sequence.paths[0] == ""
        fail_msg: The Remove Paths output is not as expected.
        success_msg: The Remove Paths output is as expected.

    - name: Remove task sequence paths
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: REMOVE-PATHS
        name: Remove Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          remove:
            - Subdirectory
        state: present
      register: _remove_paths

    - name: Verify Remove Paths previous output # noqa no-handler
      when:
        - _remove_paths is changed
      ansible.builtin.assert:
        that:
          - _remove_paths.diff.before != None
          - _remove_paths.diff.before.id == "REMOVE-PATHS"
          - _remove_paths.diff.before.name == "Remove Paths"
          - _remove_paths.diff.before.template == "Client.xml"
          - _remove_paths.diff.before.product_key_type == "none"
          - _remove_paths.diff.before.product_key is not defined
          - _remove_paths.diff.before.admin_password is not defined
          - _remove_paths.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_paths.diff.before.full_name == "Test User"
          - _remove_paths.diff.before.organization == "Test Organization"
          - _remove_paths.diff.before.ie_home_page == "about:blank"
          - _remove_paths.diff.before.version == "1.0"
          - _remove_paths.diff.before.comments == ""
          - _remove_paths.diff.before.enabled
          - not _remove_paths.diff.before.hidden
          - _remove_paths.diff.before.paths is defined
          - _remove_paths.diff.before.paths | length == 2
          - '"Subdirectory" in _remove_paths.diff.before.paths'
          - '"" in _remove_paths.diff.before.paths'
        fail_msg: The Remove Paths previous output is not as expected.
        success_msg: The Remove Paths previous output is as expected.

    - name: Verify Remove Paths output
      ansible.builtin.assert:
        that:
          - _remove_paths.task_sequence is defined
          - _remove_paths.task_sequence.id == "REMOVE-PATHS"
          - _remove_paths.task_sequence.name == "Remove Paths"
          - _remove_paths.task_sequence.template == "Client.xml"
          - _remove_paths.task_sequence.product_key_type == "none"
          - _remove_paths.task_sequence.product_key is not defined
          - _remove_paths.task_sequence.admin_password is not defined
          - _remove_paths.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _remove_paths.task_sequence.full_name == "Test User"
          - _remove_paths.task_sequence.organization == "Test Organization"
          - _remove_paths.task_sequence.ie_home_page == "about:blank"
          - _remove_paths.task_sequence.version == "1.0"
          - _remove_paths.task_sequence.comments == ""
          - _remove_paths.task_sequence.enabled
          - not _remove_paths.task_sequence.hidden
          - _remove_paths.task_sequence.paths is defined
          - _remove_paths.task_sequence.paths | length == 1
          - _remove_paths.task_sequence.paths[0] == ""
        fail_msg: The Remove Paths output is not as expected.
        success_msg: The Remove Paths output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _remove_paths_check.changed == _remove_paths.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Add and remove task sequence paths (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADD-REMOVE-PATHS
        name: Add And Remove Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          add:
            - Subdirectory
          remove:
            - ''
        state: present
      register: _add_remove_paths_check

    - name: Verify Add And Remove Paths previous output # noqa no-handler
      when:
        - _add_remove_paths_check is changed
      ansible.builtin.assert:
        that:
          - _add_remove_paths_check.diff.before != None
          - _add_remove_paths_check.diff.before.id == "ADD-REMOVE-PATHS"
          - _add_remove_paths_check.diff.before.name == "Add And Remove Paths"
          - _add_remove_paths_check.diff.before.template == "Client.xml"
          - _add_remove_paths_check.diff.before.product_key_type == "none"
          - _add_remove_paths_check.diff.before.product_key is not defined
          - _add_remove_paths_check.diff.before.admin_password is not defined
          - _add_remove_paths_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _add_remove_paths_check.diff.before.full_name == "Test User"
          - _add_remove_paths_check.diff.before.organization == "Test Organization"
          - _add_remove_paths_check.diff.before.ie_home_page == "about:blank"
          - _add_remove_paths_check.diff.before.version == "1.0"
          - _add_remove_paths_check.diff.before.comments == ""
          - _add_remove_paths_check.diff.before.enabled
          - not _add_remove_paths_check.diff.before.hidden
          - _add_remove_paths_check.diff.before.paths is defined
          - _add_remove_paths_check.diff.before.paths | length == 1
          - _add_remove_paths_check.diff.before.paths[0] == ""
        fail_msg: The Add And Remove Paths previous output is not as expected.
        success_msg: The Add And Remove Paths previous output is as expected.

    - name: Verify Add And Remove Paths output
      ansible.builtin.assert:
        that:
          - _add_remove_paths_check.task_sequence is defined
          - _add_remove_paths_check.task_sequence.id == "ADD-REMOVE-PATHS"
          - _add_remove_paths_check.task_sequence.name == "Add And Remove Paths"
          - _add_remove_paths_check.task_sequence.template == "Client.xml"
          - _add_remove_paths_check.task_sequence.product_key_type == "none"
          - _add_remove_paths_check.task_sequence.product_key is not defined
          - _add_remove_paths_check.task_sequence.admin_password is not defined
          - _add_remove_paths_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _add_remove_paths_check.task_sequence.full_name == "Test User"
          - _add_remove_paths_check.task_sequence.organization == "Test Organization"
          - _add_remove_paths_check.task_sequence.ie_home_page == "about:blank"
          - _add_remove_paths_check.task_sequence.version == "1.0"
          - _add_remove_paths_check.task_sequence.comments == ""
          - _add_remove_paths_check.task_sequence.enabled
          - not _add_remove_paths_check.task_sequence.hidden
          - _add_remove_paths_check.task_sequence.paths is defined
          - _add_remove_paths_check.task_sequence.paths | length == 1
          - _add_remove_paths_check.task_sequence.paths[0] == "Subdirectory" 
        fail_msg: The Add And Remove Paths output is not as expected.
        success_msg: The Add And Remove Paths output is as expected.

    - name: Add and remove task sequence paths
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: ADD-REMOVE-PATHS
        name: Add And Remove Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          add:
            - Subdirectory
          remove:
            - ''
        state: present
      register: _add_remove_paths

    - name: Verify Add And Remove Paths previous output # noqa no-handler
      when:
        - _add_remove_paths is changed
      ansible.builtin.assert:
        that:
          - _add_remove_paths.diff.before != None
          - _add_remove_paths.diff.before.id == "ADD-REMOVE-PATHS"
          - _add_remove_paths.diff.before.name == "Add And Remove Paths"
          - _add_remove_paths.diff.before.template == "Client.xml"
          - _add_remove_paths.diff.before.product_key_type == "none"
          - _add_remove_paths.diff.before.product_key is not defined
          - _add_remove_paths.diff.before.admin_password is not defined
          - _add_remove_paths.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _add_remove_paths.diff.before.full_name == "Test User"
          - _add_remove_paths.diff.before.organization == "Test Organization"
          - _add_remove_paths.diff.before.ie_home_page == "about:blank"
          - _add_remove_paths.diff.before.version == "1.0"
          - _add_remove_paths.diff.before.comments == ""
          - _add_remove_paths.diff.before.enabled
          - not _add_remove_paths.diff.before.hidden
          - _add_remove_paths.diff.before.paths is defined
          - _add_remove_paths.diff.before.paths | length == 1
          - _add_remove_paths.diff.before.paths[0] == ""
        fail_msg: The Add And Remove Paths previous output is not as expected.
        success_msg: The Add And Remove Paths previous output is as expected.

    - name: Verify Add And Remove Paths output
      ansible.builtin.assert:
        that:
          - _add_remove_paths.task_sequence is defined
          - _add_remove_paths.task_sequence.id == "ADD-REMOVE-PATHS"
          - _add_remove_paths.task_sequence.name == "Add And Remove Paths"
          - _add_remove_paths.task_sequence.template == "Client.xml"
          - _add_remove_paths.task_sequence.product_key_type == "none"
          - _add_remove_paths.task_sequence.product_key is not defined
          - _add_remove_paths.task_sequence.admin_password is not defined
          - _add_remove_paths.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _add_remove_paths.task_sequence.full_name == "Test User"
          - _add_remove_paths.task_sequence.organization == "Test Organization"
          - _add_remove_paths.task_sequence.ie_home_page == "about:blank"
          - _add_remove_paths.task_sequence.version == "1.0"
          - _add_remove_paths.task_sequence.comments == ""
          - _add_remove_paths.task_sequence.enabled
          - not _add_remove_paths.task_sequence.hidden
          - _add_remove_paths.task_sequence.paths is defined
          - _add_remove_paths.task_sequence.paths | length == 1
          - _add_remove_paths.task_sequence.paths[0] == "Subdirectory" 
        fail_msg: The Add And Remove Paths output is not as expected.
        success_msg: The Add And Remove Paths output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _add_remove_paths_check.changed == _add_remove_paths.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Set task sequence paths (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: SET-PATHS
        name: Set Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          set:
            - Subdirectory
        state: present
      register: _set_paths_check

    - name: Verify Set Paths previous output # noqa no-handler
      when:
        - _set_paths_check is changed
      ansible.builtin.assert:
        that:
          - _set_paths_check.diff.before != None
          - _set_paths_check.diff.before.id == "SET-PATHS"
          - _set_paths_check.diff.before.name == "Set Paths"
          - _set_paths_check.diff.before.template == "Client.xml"
          - _set_paths_check.diff.before.product_key_type == "none"
          - _set_paths_check.diff.before.product_key is not defined
          - _set_paths_check.diff.before.admin_password is not defined
          - _set_paths_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _set_paths_check.diff.before.full_name == "Test User"
          - _set_paths_check.diff.before.organization == "Test Organization"
          - _set_paths_check.diff.before.ie_home_page == "about:blank"
          - _set_paths_check.diff.before.version == "1.0"
          - _set_paths_check.diff.before.comments == ""
          - _set_paths_check.diff.before.enabled
          - not _set_paths_check.diff.before.hidden
          - _set_paths_check.diff.before.paths is defined
          - _set_paths_check.diff.before.paths | length == 1
          - _set_paths_check.diff.before.paths[0] == ""
        fail_msg: The Set Paths previous output is not as expected.
        success_msg: The Set Paths previous output is as expected.

    - name: Verify Set Paths output
      ansible.builtin.assert:
        that:
          - _set_paths_check.task_sequence is defined
          - _set_paths_check.task_sequence.id == "SET-PATHS"
          - _set_paths_check.task_sequence.name == "Set Paths"
          - _set_paths_check.task_sequence.template == "Client.xml"
          - _set_paths_check.task_sequence.product_key_type == "none"
          - _set_paths_check.task_sequence.product_key is not defined
          - _set_paths_check.task_sequence.admin_password is not defined
          - _set_paths_check.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _set_paths_check.task_sequence.full_name == "Test User"
          - _set_paths_check.task_sequence.organization == "Test Organization"
          - _set_paths_check.task_sequence.ie_home_page == "about:blank"
          - _set_paths_check.task_sequence.version == "1.0"
          - _set_paths_check.task_sequence.comments == ""
          - _set_paths_check.task_sequence.enabled
          - not _set_paths_check.task_sequence.hidden
          - _set_paths_check.task_sequence.paths is defined
          - _set_paths_check.task_sequence.paths | length == 1
          - _set_paths_check.task_sequence.paths[0] == "Subdirectory" 
        fail_msg: The Set Paths output is not as expected.
        success_msg: The Set Paths output is as expected.

    - name: Set task sequence paths
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: SET-PATHS
        name: Set Paths
        template: Client.xml
        operating_system_name: Windows 11 Enterprise
        full_name: Test User
        organization: Test Organization
        paths:
          set:
            - Subdirectory
        state: present
      register: _set_paths

    - name: Verify Set Paths previous output # noqa no-handler
      when:
        - _set_paths is changed
      ansible.builtin.assert:
        that:
          - _set_paths.diff.before != None
          - _set_paths.diff.before.id == "SET-PATHS"
          - _set_paths.diff.before.name == "Set Paths"
          - _set_paths.diff.before.template == "Client.xml"
          - _set_paths.diff.before.product_key_type == "none"
          - _set_paths.diff.before.product_key is not defined
          - _set_paths.diff.before.admin_password is not defined
          - _set_paths.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _set_paths.diff.before.full_name == "Test User"
          - _set_paths.diff.before.organization == "Test Organization"
          - _set_paths.diff.before.ie_home_page == "about:blank"
          - _set_paths.diff.before.version == "1.0"
          - _set_paths.diff.before.comments == ""
          - _set_paths.diff.before.enabled
          - not _set_paths.diff.before.hidden
          - _set_paths.diff.before.paths is defined
          - _set_paths.diff.before.paths | length == 1
          - _set_paths.diff.before.paths[0] == ""
        fail_msg: The Set Paths previous output is not as expected.
        success_msg: The Set Paths previous output is as expected.

    - name: Verify Set Paths output
      ansible.builtin.assert:
        that:
          - _set_paths.task_sequence is defined
          - _set_paths.task_sequence.id == "SET-PATHS"
          - _set_paths.task_sequence.name == "Set Paths"
          - _set_paths.task_sequence.template == "Client.xml"
          - _set_paths.task_sequence.product_key_type == "none"
          - _set_paths.task_sequence.product_key is not defined
          - _set_paths.task_sequence.admin_password is not defined
          - _set_paths.task_sequence.operating_system.name == "Windows 11 Enterprise"
          - _set_paths.task_sequence.full_name == "Test User"
          - _set_paths.task_sequence.organization == "Test Organization"
          - _set_paths.task_sequence.ie_home_page == "about:blank"
          - _set_paths.task_sequence.version == "1.0"
          - _set_paths.task_sequence.comments == ""
          - _set_paths.task_sequence.enabled
          - not _set_paths.task_sequence.hidden
          - _set_paths.task_sequence.paths is defined
          - _set_paths.task_sequence.paths | length == 1
          - _set_paths.task_sequence.paths[0] == "Subdirectory" 
        fail_msg: The Set Paths output is not as expected.
        success_msg: The Set Paths output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _set_paths_check.changed == _set_paths.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Remove task sequence by ID (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: REMOVE1
        state: absent
      register: _remove_by_id_check

    - name: Verify Remove by ID previous output # noqa no-handler
      when:
        - _remove_by_id_check is changed
      ansible.builtin.assert:
        that:
          - _remove_by_id_check.diff.before != None
          - _remove_by_id_check.diff.before.id == "REMOVE1"
          - _remove_by_id_check.diff.before.name == "Remove by ID"
          - _remove_by_id_check.diff.before.template == "Client.xml"
          - _remove_by_id_check.diff.before.product_key_type == "none"
          - _remove_by_id_check.diff.before.product_key is not defined
          - _remove_by_id_check.diff.before.admin_password is not defined
          - _remove_by_id_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_by_id_check.diff.before.full_name == "Test User"
          - _remove_by_id_check.diff.before.organization == "Test Organization"
          - _remove_by_id_check.diff.before.ie_home_page == "about:blank"
          - _remove_by_id_check.diff.before.version == "1.0"
          - _remove_by_id_check.diff.before.comments == ""
          - _remove_by_id_check.diff.before.enabled
          - not _remove_by_id_check.diff.before.hidden
          - _remove_by_id_check.diff.before.paths is defined
          - _remove_by_id_check.diff.before.paths | length == 1
          - _remove_by_id_check.diff.before.paths[0] == ""
        fail_msg: The Remove by ID previous output is not as expected.
        success_msg: The Remove by ID previous output is as expected.

    - name: Verify Remove by ID output
      ansible.builtin.assert:
        that:
          - _remove_by_id_check.task_sequence is not defined
        fail_msg: The Remove by ID output is not as expected.
        success_msg: The Remove by ID output is as expected.

    - name: Remove task sequence by ID
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        id: REMOVE1
        state: absent
      register: _remove_by_id

    - name: Verify Remove by ID previous output # noqa no-handler
      when:
        - _remove_by_id is changed
      ansible.builtin.assert:
        that:
          - _remove_by_id.diff.before != None
          - _remove_by_id.diff.before.id == "REMOVE1"
          - _remove_by_id.diff.before.name == "Remove by ID"
          - _remove_by_id.diff.before.template == "Client.xml"
          - _remove_by_id.diff.before.product_key_type == "none"
          - _remove_by_id.diff.before.product_key is not defined
          - _remove_by_id.diff.before.admin_password is not defined
          - _remove_by_id.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_by_id.diff.before.full_name == "Test User"
          - _remove_by_id.diff.before.organization == "Test Organization"
          - _remove_by_id.diff.before.ie_home_page == "about:blank"
          - _remove_by_id.diff.before.version == "1.0"
          - _remove_by_id.diff.before.comments == ""
          - _remove_by_id.diff.before.enabled
          - not _remove_by_id.diff.before.hidden
          - _remove_by_id.diff.before.paths is defined
          - _remove_by_id.diff.before.paths | length == 1
          - _remove_by_id.diff.before.paths[0] == ""
        fail_msg: The Remove by ID previous output is not as expected.
        success_msg: The Remove by ID previous output is as expected.

    - name: Verify Remove by ID output
      ansible.builtin.assert:
        that:
          - _remove_by_id.task_sequence is not defined
        fail_msg: The Remove by ID output is not as expected.
        success_msg: The Remove by ID output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _remove_by_id_check.changed == _remove_by_id.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.

    - name: Remove task sequence by name (check)
      check_mode: true
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        name: Remove by Name
        state: absent
      register: _remove_by_name_check

    - name: Verify Remove by Name previous output # noqa no-handler
      when:
        - _remove_by_name_check is changed
      ansible.builtin.assert:
        that:
          - _remove_by_name_check.diff.before != None
          - _remove_by_name_check.diff.before.id == "REMOVE2"
          - _remove_by_name_check.diff.before.name == "Remove by Name"
          - _remove_by_name_check.diff.before.template == "Client.xml"
          - _remove_by_name_check.diff.before.product_key_type == "none"
          - _remove_by_name_check.diff.before.product_key is not defined
          - _remove_by_name_check.diff.before.admin_password is not defined
          - _remove_by_name_check.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_by_name_check.diff.before.full_name == "Test User"
          - _remove_by_name_check.diff.before.organization == "Test Organization"
          - _remove_by_name_check.diff.before.ie_home_page == "about:blank"
          - _remove_by_name_check.diff.before.version == "1.0"
          - _remove_by_name_check.diff.before.comments == ""
          - _remove_by_name_check.diff.before.enabled
          - not _remove_by_name_check.diff.before.hidden
          - _remove_by_name_check.diff.before.paths is defined
          - _remove_by_name_check.diff.before.paths | length == 1
          - _remove_by_name_check.diff.before.paths[0] == ""
        fail_msg: The Remove by Name previous output is not as expected.
        success_msg: The Remove by Name previous output is as expected.

    - name: Verify Remove by Name output
      ansible.builtin.assert:
        that:
          - _remove_by_name_check.task_sequence is not defined
        fail_msg: The Remove by Name output is not as expected.
        success_msg: The Remove by Name output is as expected.

    - name: Remove task sequence by name
      diff: true
      trippsc2.mdt.task_sequence:
        mdt_share_path: C:\MDTShare
        name: Remove by Name
        state: absent
      register: _remove_by_name

    - name: Verify Remove by Name previous output # noqa no-handler
      when:
        - _remove_by_name is changed
      ansible.builtin.assert:
        that:
          - _remove_by_name.diff.before != None
          - _remove_by_name.diff.before.id == "REMOVE2"
          - _remove_by_name.diff.before.name == "Remove by Name"
          - _remove_by_name.diff.before.template == "Client.xml"
          - _remove_by_name.diff.before.product_key_type == "none"
          - _remove_by_name.diff.before.product_key is not defined
          - _remove_by_name.diff.before.admin_password is not defined
          - _remove_by_name.diff.before.operating_system.name == "Windows 11 Enterprise"
          - _remove_by_name.diff.before.full_name == "Test User"
          - _remove_by_name.diff.before.organization == "Test Organization"
          - _remove_by_name.diff.before.ie_home_page == "about:blank"
          - _remove_by_name.diff.before.version == "1.0"
          - _remove_by_name.diff.before.comments == ""
          - _remove_by_name.diff.before.enabled
          - not _remove_by_name.diff.before.hidden
          - _remove_by_name.diff.before.paths is defined
          - _remove_by_name.diff.before.paths | length == 1
          - _remove_by_name.diff.before.paths[0] == ""
        fail_msg: The Remove by Name previous output is not as expected.
        success_msg: The Remove by Name previous output is as expected.

    - name: Verify Remove by Name output
      ansible.builtin.assert:
        that:
          - _remove_by_name.task_sequence is not defined
        fail_msg: The Remove by Name output is not as expected.
        success_msg: The Remove by Name output is as expected.

    - name: Verify check mode made no changes
      ansible.builtin.assert:
        that:
          - _remove_by_name_check.changed == _remove_by_name.changed
        fail_msg: The module made changes when it should not have.
        success_msg: The module did not make changes when it should not have.
